//>>built
require({cache:{"ws/mail/MessageListView":function(){require({cache:{"url:ws/mail/MessageListView.html":'<div>\n\t<div data-dojo-type="ws/widget/WSSplitContainer" style="height: 100%; width: 100%;" data-dojo-attach-point="splitContainer" sizerWidth="10" orientation="vertical" persist="false">\n\t\t<div class="listView messageListView" data-dojo-type="dijit/layout/BorderContainer" data-dojo-attach-point="layoutWidget">\n            <div data-dojo-type="ws/widget/SingleLineNotification" data-dojo-attach-point="notification" class="notification" data-dojo-props="region:\'top\'" style="display:none"></div>\n\t\t\t<div data-dojo-type="ws/widget/WSToolbar" data-dojo-attach-point="toolbar" data-dojo-props="region:\'top\'" vizType="Controls">\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="restoreButton" iconClassName="restoreIcon" data-dojo-attach-event="onClick: onClickRestore" title="${RestoreButton}">${RestoreButton}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="keepNewButton" iconClassName="keepNewIcon" data-dojo-attach-event="onClick: markMessagesUnread" title="${MsgListKeepAsNewTip}" tip="${KeepAsNewActionLabel} <span>(${KeyMailKeepAsNew})</span>">${KeepAsNewActionLabel}</div>\n\t\t\t\t<div style="display:none" data-dojo-type="ws/widget/Button" data-dojo-attach-event="onClick: editDraft, onMouseDown: savePreviewPaneSelection" data-dojo-attach-point="editDraftButton" iconClassName="editDraftIcon" title="${EditDraft}">${EditDraft}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-event="onClick: reply, onMouseDown: savePreviewPaneSelection" data-dojo-attach-point="replyButton" iconClassName="replyIcon" title="${DisplayReply} (${KeyMailReply})" tip="${DisplayReply} <span>(${KeyMailReply})</span>">${DisplayReply}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-event="onClick: replyAll, onMouseDown: savePreviewPaneSelection" data-dojo-attach-point="replyAllButton" iconClassName="replyAllIcon" title="${DisplayReplyAll} (${KeyMailReplyAll})" tip="${DisplayReplyAll} <span>(${KeyMailReplyAll})</span>">${DisplayReplyAll}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-event="onClick: forward, onMouseDown: savePreviewPaneSelection" data-dojo-attach-point="forwardButton" iconClassName="forwardIcon" title="${DisplayForward} (${KeyMailForward})" tip="${DisplayForward} <span>(${KeyMailForward})</span>">${DisplayForward}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="restartIMButton" data-dojo-attach-event="onClick: restartIM" iconClassName="iconIM" title="${DisplayIM}">${DisplayIM}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/DropDownButton" data-dojo-attach-point="comboIMButton" iconClassName="imIcon" title="${SendIM}">${SendIMPrefix}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/DropDownButton" data-dojo-attach-point="actionButton" iconClassName="actionIcon" tip="${ActionButtonTip}" title="${ActionButtonTip}">${ActionButton}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="deleteButton" iconClassName="delIcon" data-dojo-attach-event="onClick:onClickDelete" tip="${DeleteButton} <span>(${DeleteKey})</span>">${DeleteButton}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="spamButton" iconClassName="spamIcon" data-dojo-attach-event="onClick: reportSpam" title="${MsgListSpamTip}" tip="${ReportSpamTooltip} <span>(${KeyMailSpam})</span>">${ReportSpamButton}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="notSpamButton" iconClassName="notSpamIcon" data-dojo-attach-event="onClick: reportNotSpam" title="${NotSpamButton} <span>(${KeyMailSpam})</span>">${NotSpamButton}</div>\n\t\t\t\t<div data-dojo-props="toolbarPosition: \'right\'" data-dojo-type="ws/widget/Pane" class="msgListTbRight">\n\t\t\t\t\t<div data-dojo-type="ws/widget/DropDownButton" data-dojo-attach-point="filterButton" widgetId="filterDropDown"></div>\n\t\t\t\t\t<div data-dojo-type="ws/widget/DropDownButton" data-dojo-attach-point="customizeButton">${Customize}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div data-dojo-type="ws/widget/Pane" data-dojo-attach-point="searchInfoPane" class="searchInfo" data-dojo-props="region:\'top\'" style="display:none">\n\t\t\t\t<div class="searchData">\n\t\t\t\t\t<span data-dojo-attach-point="searchResultsNode"></span>\n\t\t\t\t</div>\n\t\t\t\t<div data-dojo-type="ws/widget/DropDownButton" type="Bare" data-dojo-attach-point="fsButton" title="${FilterSearchTip}" size="Large">${FilterSearch}</div>\n\t\t\t\t<div class="mainSprite wsCloseBtn" data-dojo-attach-event="onclick:clearSearch"></div>\n\t\t\t</div>\n\t\t\t<div data-dojo-type="ws/widget/Pane" data-dojo-attach-point="forwardingInfoPane" class="searchInfo" data-dojo-props="region:\'top\'" style="display: none;">\n\t\t\t\t<div style="float:left">\n\t\t\t\t\t<span data-dojo-attach-point="forwardingInfoNode"></span>\n\t\t\t\t\t&nbsp;&nbsp;\n\t\t\t\t\t<span class="wsLink" data-dojo-attach-event="onclick: openPremiumSettings" title="${PremiumForwardingOnTitle}">${Edit}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div data-dojo-type="ws/widget/Pane" data-dojo-attach-point="mlistAdCont" class="mlistAdCont" data-dojo-props="region:\'top\'">\n\t\t\t\t<div data-dojo-attach-point="mlistAd" class="mlistAd">\n\t\t\t\t</div>\n\t\t\t\t<div class="mainSprite mlistAdClose" data-dojo-attach-point="mlistAdClose" data-dojo-attach-event="onclick: closeAd"></div>\n\t\t\t</div>\n\t\t\t<div data-dojo-type="ws/widget/Pane" data-dojo-props="region:\'center\'">\n\t\t\t\t<div data-dojo-attach-point="grid" data-dojo-type="dojox.grid.Grid"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="emptyFolderAdDiv" style="display:none;height: 100%; width: 100%;" data-dojo-attach-point="emptyFolderAdDiv"></div>\n</div>',
"url:ws/mail/MessageListView.css":""}});define("ws/mail/MessageListView","dojo/_base/declare,dojo/text!ws/mail/MessageListView.html,dojo/text!ws/mail/MessageListView.css,dojo,dijit,dojo/window,dojo/cookie,ws/widget/ListView,ws/widget/WSMenu,ws/widget/WSMenuItem,ws/widget/WSMenuSeparator,ws/widget/Pane,ws/mail/MessageStatusDialog,ws/widget/Advertisement,dojo/request/script,dijit/layout/BorderContainer,ws/widget/WSSplitContainer,ws/widget/DropDownButton,dojox/grid/Grid,ws/date,ws/io,ws/lang,ws/reporting,ws/string,ws/widget/util,ws/widget/Button,ws/widget/WSToolbar,ws/widget/SingleLineNotification,ws/mail/MessageGridModel".split(","),
function(p,q,s,b,j,g,l,h,o,m,n,t,u,r,v){return p(h,{templateString:q,css:{templateString:s},hoverColumnHtml:'<div class="hoverControl trashHover" title="'+Config.Strings.DeleteMessageTip+'"></div>',speedUp:!0,quickActionCol:3,wrapperModelClass:ws.mail.MessageGridModel,currentSearchIn:"alltext",dragType:"message",autosizeColumnId:"Subject",origPrefsWidth:{},columnDefaults:null,cookiePrefs:null,prefsVer:1.1,lastClickTime:0,lastClickUid:0,fetchNotificationCount:5,currentMsgListAd:null,msgListKeywordAdId:null,
postCreate:function(){b.subscribe("DisplayMessage/deleteMessage",b.hitch(this,"deleteMessages"));b.subscribe("ListSpacingResize",b.hitch(this,function(){this.grid.update()}))},initView:function(){this.initColumns();this.defineMenus();this.inherited(arguments);this.defSort=-(this.columnDefaults.Received.order-1);b.connect(this.model,"modelUpdated",this,"modelUpdated");b.connect(this.model,"folderListChanged",this,"updateActionMenuFolders");b.connect(this.toolbar,"wrap",this,"wrapToolbar");b.connect(this.model,
"search",b.hitch(this,function(){this.onSelectionChange(!0)}));b.connect(this.model,"onSelectionChange",this,"onSelectionChange");this.filterButton.getMenu();this.customizeButton.getMenu();b.connect(ws.WebSuite,"processKeyPress",this,"onKeyPress");b.connect(this.grid,"onCellDblClick",this,"handleCellDblClick");this.subscribe("toolbarLayoutUpdate","resize");this.subscribe("snippetViewUpdate",function(){ws.WebSuite.snippetsOn=!ws.WebSuite.snippetsOn;this.grid.update()});this.deleteButton.domNode.title=
ws.string.substituteParams(Config.Strings.DeleteTip,Settings.DeletedFolderDisplayName);Config.UseOMS&&Config.CrossFolderSearch?this.showFilterSearchMenu():this.hideFilterSearchMenu();this.initSplitContainer();Config.EnablePreviewPane&&(Settings.EnablePreviewPane||!Settings.PreviewPaneIntroSeen)?(!Settings.PreviewPaneIntroSeen&&Settings.EnablePreviewPane&&this.savePreviewPaneSettings({PreviewPaneIntroSeen:!0}),this.setPreviewPaneEnabled(!0)):this.setPreviewPaneEnabled(!1);ws.WebSuite.SidePanel.setupAdScroll(this.grid.views.views[0].scrollboxNode,
"mlist");this.setupInlineAd()},initColumns:function(a){this.columnDefaults={Select:{order:0,width:36,hidden:!1},Account:{order:1,width:16,hidden:!0},FromTo:{order:2,width:150,min:75,max:250,hidden:!1},Type:{order:3,width:16,hidden:!1},Attachment:{order:4,width:16,hidden:!1},Subject:{order:5,width:250,min:100,max:400,hidden:!1},Received:{order:6,width:72,min:72,max:250,hidden:!1},Hover:{order:7,width:16,hidden:!1},Flag:{order:8,width:16,hidden:!1},Size:{order:9,width:45,hidden:!0}};this.cookieKeyMap=
{FromTo:"f",Subject:"s",Received:"r"};if(Config.UseOMS&&Config.CrossFolderSearch)this.columnDefaults.Folder={order:9,width:60,min:60,max:250,hidden:!0},this.columnDefaults.Size={order:10,width:45,hidden:!0};this.columns=[];var c=b.fromJson(Settings.MessageListPrefs),d=!0,e;for(e in c){d=!1;break}e=!1;if(!d&&(!c.version||c.version<this.prefsVer))e=a=!0;if(a||!c||""==c||d)c=ws.lang.shallowCopy(this.columnDefaults,!0);if(!this.cookiePrefs&&l.isSupported())this.cookiePrefs=ws.io._getObjectCookie("WSCliSettings",
"=");d=null;if(this.cookiePrefs&&this.cookiePrefs.cw)for(var f={},i=this.cookiePrefs.cw.split(","),g=0;g<i.length;g++){var h=i[g].split(":");1<h.length&&(f[h[0]]=h[1],d=f)}var f={},k;for(k in this.columnDefaults)if(f[k]=c[k]?ws.lang.shallowCopy(c[k],!0):ws.lang.shallowCopy(this.columnDefaults[k],!0),f[k].width=f[k].width?f[k].width:this.columnDefaults[k].width,this.origPrefsWidth[k]=f[k].width,!a&&d&&this.cookieKeyMap[k]&&d[this.cookieKeyMap[k]])f[k].width=d[this.cookieKeyMap[k]];this.autoWidthSizedTo=
0;if(f&&f.Subject&&f.Subject.width&&f.Subject.width!=this.columnDefaults.Subject.width)this.autoWidthSizedTo=f.Subject.width;try{var j=Config.Strings.From,m=Config.Strings.Subject,n=Config.Strings.Date,w=Config.Strings.Size;this.columns[f.Select.order]={id:"Select",name:"<div class='gridIcon ws_image_chkOffIcon'></div>",width:this.columnDefaults.Select.width+"px",hidden:f.Select.hidden,noresize:!0,formatter:b.hitch(this,"formatSprite",this.baseSprites.chkBox)};this.columns[f.Type.order]={id:"Type",
name:"<div class='gridIcon ws_image_typeIcon'></div>",classes:"gridColType",width:this.columnDefaults.Type.width+"px",hidden:f.Type.hidden,noresize:!0,formatter:b.hitch(this,"formatSprite",this.sprites.type)};this.columns[f.FromTo.order]={id:"FromTo",name:j,classes:"gridColFrom",width:f.FromTo.width+"px",hidden:f.FromTo.hidden};this.columns[f.Hover.order]={id:"Hover",name:" ",classes:"gridColHov",width:this.columnDefaults.Hover.width+"px",hidden:f.Hover.hidden,noresize:!0};this.columns[f.Attachment.order]=
{id:"Attachment",name:"<div class='gridIcon ws_image_attachIcon'></div>",classes:"gridColAttach",width:this.columnDefaults.Attachment.width+"px",hidden:f.Attachment.hidden,noresize:!0,formatter:b.hitch(this,"formatSprite",this.sprites.attach)};this.columns[f.Subject.order]={id:"Subject",name:m,classes:"gridColSub",width:f.Subject.width+"px",hidden:f.Subject.hidden};this.columns[f.Received.order]={id:"Received",name:n,width:f.Received.width+"px",hidden:f.Received.hidden};this.columns[f.Flag.order]=
{id:"Flag",name:"<div class='gridIcon ws_image_flagIcon'></div>",classes:"gridColFlag",width:this.columnDefaults.Flag.width+"px",hidden:f.Flag.hidden,noresize:!0,formatter:b.hitch(this,"formatSprite",this.sprites.flag)};this.columns[f.Size.order]={id:"Size",name:w,width:f.Size.width+"px",hidden:f.Size.hidden,noresize:!0};this.columns[f.Account.order]={id:"Account",name:"<div class='gridIcon ws_image_AcctIcon'></div>",classes:"gridColAct",width:this.columnDefaults.Account.width+"px",hidden:f.Account.hidden,
noresize:!0,formatter:b.hitch(this,"formatAcctSprite",this.sprites.account)};if(Config.UseOMS&&Config.CrossFolderSearch){var o=this.columnDefaults.Folder;this.columns[o.order]={id:"Folder",name:"Folder",width:o.width+"px",hidden:o.hidden};this.columnMenuSpec=[{caption:Config.Strings.ColumnInfo,checked:!1,onClick:b.hitch(this,"toggleColumn","Type")},{caption:Config.Strings.From,checked:!1,onClick:b.hitch(this,"toggleColumn","FromTo")},{caption:Config.Strings.ColumnQuick,checked:!1,onClick:b.hitch(this,
"toggleColumn","Hover")},{caption:Config.Strings.Attachments,checked:!1,onClick:b.hitch(this,"toggleColumn","Attachment")},{caption:Config.Strings.Subject,checked:!1,onClick:b.hitch(this,"toggleColumn","Subject")},{caption:Config.Strings.Date,checked:!1,onClick:b.hitch(this,"toggleColumn","Received")},{caption:Config.Strings.ColumnFlag,checked:!1,onClick:b.hitch(this,"toggleColumn","Flag")},{caption:Config.Strings.Account,checked:!1,onClick:b.hitch(this,"toggleColumn","Account")},{caption:Config.Strings.Size,
checked:!1,onClick:b.hitch(this,"toggleColumn","Size")},{separator:!0},{caption:Config.Strings.ColumnReset,onClick:b.hitch(this,"toggleColumn","RESET")}]}else this.columnMenuSpec=[{caption:Config.Strings.ColumnInfo,checked:!1,onClick:b.hitch(this,"toggleColumn","Type")},{caption:Config.Strings.From,checked:!1,onClick:b.hitch(this,"toggleColumn","FromTo")},{caption:Config.Strings.ColumnQuick,checked:!1,onClick:b.hitch(this,"toggleColumn","Hover")},{caption:Config.Strings.Attachments,checked:!1,onClick:b.hitch(this,
"toggleColumn","Attachment")},{caption:Config.Strings.Subject,checked:!1,onClick:b.hitch(this,"toggleColumn","Subject")},{caption:Config.Strings.Date,checked:!1,onClick:b.hitch(this,"toggleColumn","Received")},{caption:Config.Strings.ColumnFlag,checked:!1,onClick:b.hitch(this,"toggleColumn","Flag")},{caption:Config.Strings.Size,checked:!1,onClick:b.hitch(this,"toggleColumn","Size")},{separator:!0},{caption:Config.Strings.ColumnReset,onClick:b.hitch(this,"toggleColumn","RESET")}];var x=b.filter(this.columns,
function(a){return!a.hidden});this.grid.sortInfo=-(ws.lang.findByProp(x,"id","Received")+1);a&&this.grid.setStructure([{cells:[this.columns]}]);if(e)this.onHeaderColumnChange(null,!1)}catch(p){a||this.initColumns(!0)}},formatAcctSprite:function(a,c){if(c){var b=c.sort&&c[1]||"",c=c.sort&&c[0]||c;return ws.string.substituteParams("<div class='gridIcon %{0}' title='%{1}'></div>",a&&a[c]?a[c]:a.generic,b)}},onHeaderColumnChange:function(a,c){if(!this.columnDefaults.Folder||this.columnDefaults.Folder.hidden){var d=
{version:this.prefsVer};this.cookiePrefs=this.cookiePrefs||{cw:""};this.cookiePrefs.cw="";if(c)for(var e in this.columnDefaults){if("Folder"!=e){var f=this.columnDefaults[e],i={},g;for(g in f)"min"!=g&&"max"!=g&&("width"==g?(this.columns[f.order].noresize||(this.cookiePrefs.cw+=this.cookieKeyMap[e]+":"+f[g]+","),i[g]=this.origPrefsWidth[e]):i[g]=f[g]);d[e]=i}}else{e=this.columns;f=this.grid.views.views[0].structure.rows[0];for(i=0;i<e.length;i++)if(g=e[i],"Folder"!=g.id){var h=ws.lang.findByProp(f,
"id",g.id),h=parseInt(-1==h?g.width:f[h].unitWidth);b.isWebKit&&(h-=this.cellWidthPad);"Subject"==g.id&&(h=this.autoWidthSizedTo?h:this.columnDefaults.Subject.width);d[g.id]={order:i,hidden:g.hidden,width:this.origPrefsWidth[g.id]};g.noresize||(this.cookiePrefs.cw+=this.cookieKeyMap[g.id]+":"+h+",")}}l.isSupported()&&ws.io._setObjectCookie(this.cookiePrefs,"WSCliSettings",null,"/",730);ws.settings.saveSoon({MessageListPrefs:d})}},onHeaderContextMenu:function(a){b.stopEvent(a);ws.lang.ensureLayersLoaded(b.hitch(this,
"_onHeaderContextMenu",a.pageX,a.pageY))},_onHeaderContextMenu:function(a,c){if(!this.columnMenu)this.columnMenu=ws.widget.createMenu(this.columnMenuSpec),this.columnMenu.startup();var b=this.gridModel.columns,e=this.columnMenu.getChildren();e[0].setChecked(-1!=b.Type);e[1].setChecked(-1!=b.FromTo);e[2].setChecked(-1!=b.Hover);e[3].setChecked(-1!=b.Attachment);e[4].setChecked(-1!=b.Subject);e[5].setChecked(-1!=b.Received);e[6].setChecked(-1!=b.Flag);e[7].setChecked(-1!=b.Account);e[8].setChecked(-1!=
b.Size);this.columnMenu.open(a,c)},setupKeywordAD:function(){var a=this,c,b=!1,e,f;if(this.keywordToMnMappings){f=this.model.getSearchString().toLowerCase();for(var i=0;i<this.keywordToMnMappings.length;i++)if(e=this.keywordToMnMappings[i],c=e.id,!ws.WebSuite.hasNotifcationBeenSeen(c)){c=e.keywords;for(var g=0;g<c.length;g++)if(-1!=f.indexOf(c[g])){b=!0;break}if(b){this.showKeywordAd(e.mnSSL,e.id,e.close);break}}b||this.setupInlineAd()}else v.get("https://"+Config.TodayPageHost+"/mapper",{jsonp:"callback",
query:{locale:Config.PageLocale,brand:Config.UIVariant.toLowerCase(),view:"mapper",spot:"keyword_to_mn"},preventCache:!0}).then(function(c){a.keywordToMnMappings=c;a.setupKeywordAD()},function(){a.keywordToMnMappings=[]})},hideAdWidget:function(){if(this.adWidget&&this.adWidget.domNode&&!this.adWidget.isHidden())this.adWidget.hideAd(!0),this.mlistAdCont.domNode.style.display="none"},hideKeywordAdWidget:function(){if(this.adKeywordWidget&&this.adKeywordWidget.domNode&&!this.adKeywordWidget.isHidden())this.adKeywordWidget.hideAd(!0),
this.mlistAdCont.domNode.style.display="none"},showKeywordAd:function(a,c,b){this.hideAdWidget();this.mlistAdCont.domNode.style.display="block";this.mlistAdClose.style.display=b?"block":"none";this.adKeywordWidget&&this.adKeywordWidget.domNode?this.adKeywordWidget.hideAd(!1):(this.adKeywordWidget=new r({adtype:"mlistinlinekeyword"}),this.adKeywordWidget.startup(),this.adKeywordWidget.currentMagic=a,this.adKeywordWidget.setAdId(c),this.adKeywordWidget.adConfig&&this.mlistAd.appendChild(this.adKeywordWidget.domNode));
this.currentMsgListAd=this.adKeywordWidget;this.layoutWidget.layout()},doKeywordToMnMapping:function(){var a=this.model.getSearchIn();return this.model.getSearchString()&&0!=this.model.getRowCount()&&("alltext"==a||"subject"==a||"fromto"==a)&&!this.model.isErrorState()&&!this.model.isNetErrorState()},modelUpdated:function(){Config.EnableKeywordToMnAds&&(this.doKeywordToMnMapping()?this.setupKeywordAD():this.setupInlineAd());this.updateFilterButton();this.model.trackdl("-MLV.MUa",this.reportFolderName);
this.updateSearchInfo();this.updateColumnCaptions();this.updateSpamDspVisibility();this.onSelectionChange();ws.WebSuite.SidePanel.setupAdScroll(this.grid.views.views[0].scrollboxNode,"mlist")},updateSpamDspVisibility:function(){var a=this.model.getCurrentFolder();a&&"Spam"==a.type||Settings.EnableSpamDisposition?b.removeClass(this.layoutWidget.domNode,"msgListHiddenSDicon"):b.addClass(this.layoutWidget.domNode,"msgListHiddenSDicon")},updateToolbarState:function(){if(this.model){var a=this.model.getCurrentFolder(),
c=a?a.name.toLowerCase():"inbox",a=a?a.type:"Inbox";this.buttonViz=b.map((c in Config.FolderButtons?Config.FolderButtons[c]:Config.FolderButtons.other).split(","),function(a){return"true"==b.trim(a)});this.spamButton.setShowing(this.buttonViz[4]&&Config.EnableSpamButton);this.notSpamButton.setShowing(this.buttonViz[5]);this.restoreButton.setShowing(this.buttonViz[8]||"Deleted"==a&&Settings.ViewNewOld);this.keepNewButton.setShowing(this.buttonViz[12]&&Settings.ViewNewOld);c="Drafts"==a;a=Settings.EnablePreviewPane||
!Settings.PreviewPaneIntroSeen;this.replyButton.setShowing(a&&!c);this.replyAllButton.setShowing(a&&!c);this.forwardButton.setShowing(a&&!c);this.editDraftButton.setShowing(c);this.filterButton.setShowing(null==this.model.getSearchString());this.filterButton.containerNode.innerHTML||this.updateFilterButton();this.restartIMButton.setShowing(this.previewPane&&this.model.currentUid&&this.previewPane.restartIMButton&&this.previewPane.restartIMButton.isShowing());c=this.previewPane&&this.model.currentUid&&
this.previewPane.comboIMButton&&this.previewPane.comboIMButton.isShowing();this.comboIMButton.setShowing(c);c&&ws.widget.updateIMButton(this.comboIMButton);"none"!=this.domNode.style.display&&this.toolbar.layout()}},updateColumnCaptions:function(){var a=this.gridModel.columns.FromTo;if(-1!=a){var c=this.model.getCurrentFolder()||{},b=c.type,c="Sent"==b||"Drafts"==b||"AutoSavedSent"==b||c.name==Config.IMFolderName?Config.Strings.To:Config.Strings.From;if(this.model.getSearchString()&&Config.UseOMS&&
Config.CrossFolderSearch)c=Config.Strings.FromTo;this.grid.views.views[0].structure.rows[0][a].name=c;this.grid.views.views[0].renderHeader()}},displayFolder:function(a,c,b,e,f){var i=this.model.getFolderByName(a);ws.reporting.DL.startEvent("list_folder",a,{opData:i&&i.displayName?i.displayName:""});this.model.trackdl("-MLV.DFa",a);this.gridModel.reportFolderName=a;this.prevPaneDelayTimeoutId=null;this.grid.rows.setOverRow(0);this._unselect0row=!1;(i=this.model.sortIndices[this.gridModel.getSortColumnIndex(Math.abs(this.grid.sortInfo)-
1)])||(i="received");this.model.setFolder(a,c,b,e,i,0>this.grid.sortInfo?"descending":"ascending",!1,f);this.scrollIntoView(0);this.model.trackdl("-MLV.DFz",a)},clearSearch:function(){this.model.search(null);Config.UseOMS&&Config.CrossFolderSearch&&this.toggleColumn("Folder",!0);ws.WebSuite.clearSearch();ws.WebSuite.Navigation.searchActive(!1,this.searchInfoPane.domNode);b.publish("WSFeedbackEnd",[Config.Strings.Loading])},updateSearchInfo:function(){this.model.trackdl("-MLV.USa","search_mail");if("messageList"==
ws.WebSuite.getCurrentViewId()){var a=this.model.getSearchString(),c=a,b=this.searchInfoPane.isShowing();if(a&&!this.model.isLoading()){this.model.getSearchIn();Config.UseOMS&&Config.CrossFolderSearch?(c=this.model.getDisplayableSearchHeaderStr(!0),this.searchResultsNode.innerHTML=c,this.showFilterSearchMenu()):(c=this.model.getDisplayableSearchHeaderStr(),this.searchResultsNode.innerHTML=c,this.hideFilterSearchMenu());this.forwardingInfoPane.isShowing()&&this.forwardingInfoPane.hide();this.searchInfoPane.show();
ws.WebSuite.Navigation.searchActive(!0,this.searchInfoPane);ws.WebSuite.Navigation.hiliteCurrentApp();b||this.layoutWidget.layout();if(Config.UseOMS&&Config.CrossFolderSearch&&this.columnDefaults.Folder.hidden)this.columnDefaults.Folder.hidden=!1,this.toggleColumn("Folder",!1);Config.UseOMS&&Config.CrossFolderSearch&&!this.model.sSubSearch&&this.updateSearchFilterMenu();a=Config.DLReportSearchResult?this.model.getSearchMailResultDL():"";null!=this.model.getErrCode()?(this.model.trackdl("-MLV.USb",
"search_mail"),ws.reporting.DL.endEvent("search_mail",{opResult:"fail",errType:"api",errCode:this.model.getErrCode(),sessionID:Settings.SessionID,op1:a})):(this.model.trackdl("-MLV.USc","search_mail"),ws.reporting.DL.endEvent("search_mail",{opResult:"success",sessionID:Settings.SessionID,op1:a}))}else{this.model.trackdl("-MLV.USd","search_mail");this.searchInfoPane.hide();ws.WebSuite.Navigation.searchActive(!1,this.searchInfoPane);ws.WebSuite.Navigation.hiliteCurrentApp();this.updateForwardingInfo();
if(Config.UseOMS&&Config.CrossFolderSearch&&!this.columnDefaults.Folder.hidden)this.columnDefaults.Folder.hidden=!0,this.toggleColumn("Folder",!0);b&&this.layoutWidget.layout()}ws.WebSuite.showNotification(this)}},limitStr:function(a,c){return!c||a.length<=c?a:a.substring(0,c)+"&hellip;"},showFilterSearchMenu:function(){this.fsButton.show();b.addClass(this.searchInfoPane.domNode,"filterButtonVisible")},hideFilterSearchMenu:function(){this.fsButton.hide();b.removeClass(this.searchInfoPane.domNode,
"filterButtonVisible")},updateSearchFilterMenu:function(){var a=this.model&&this.model.activeCachedList&&this.model.activeCachedList.data?this.model.activeCachedList.data.searchCounts:null;if(a){this.showFilterSearchMenu();var c=1,d="sfm"+c++,e,f=[{id:d,caption:ws.string.substituteParams("%{0}<span class='fsItemCount'>%{1}</span>",Config.Strings.FSAllResults,this.model.getRowCount()),onClick:b.hitch(this,"filterSearch",d)},{separator:!0}],i;if(Settings.HasAggregatedAccount&&a.accts){f.push({isLabel:!0,
caption:Config.Strings.FSAcctTitle});for(i=0;i<a.accts.length;i++)d="sfm"+c++,e=a.accts[i].n.toLowerCase()==this.model.getIdentities()[0][1]?"Inbox":a.accts[i].n,f.push({id:d,caption:ws.string.substituteParams("%{0}<span class='fsItemCount'>%{1}</span>",this.limitStr(a.accts[i].fn,22),a.accts[i].cnt),onClick:b.hitch(this,"filterSearch",d,"d:"+e)});f.push({separator:!0})}if(a.folders){f.push({isLabel:!0,caption:Config.Strings.FSFolderTitle});for(i=0;i<a.folders.length;i++)d="sfm"+c++,f.push({id:d,
caption:ws.string.substituteParams("%{0}<span class='fsItemCount'>%{1}</span>",this.limitStr(a.folders[i].fn,22),a.folders[i].cnt),onClick:b.hitch(this,"filterSearch",d,"f:"+a.folders[i].n)});f.push({separator:!0})}if(a.senders){f.push({isLabel:!0,caption:Config.Strings.FSSenderTitle});for(i=0;i<a.senders.length;i++)d="sfm"+c++,f.push({id:d,caption:ws.string.substituteParams("%{0}<span class='fsItemCount'>%{1}</span>",this.limitStr(a.senders[i].fn,22),a.senders[i].cnt),onClick:b.hitch(this,"filterSearch",
d,"s:"+a.senders[i].n)})}if(0<a.sent||0<a.att)f.push({separator:!0}),f.push({isLabel:!0,caption:Config.Strings.FSMsgTypeTitle}),0<a.sent&&(d="sfm"+c++,f.push({id:d,caption:ws.string.substituteParams("%{0}<span class='fsItemCount'>%{1}</span>",Config.Strings.FSMsgsSent,a.sent?a.sent:0),onClick:b.hitch(this,"filterSearch",d,"m:")})),0<a.att&&(d="sfm"+c++,f.push({id:d,caption:ws.string.substituteParams("%{0}<span class='fsItemCount'>%{1}</span>",Config.Strings.FSMsgsAtt,a.att?a.att:0),onClick:b.hitch(this,
"filterSearch",d,"a:")}));this.fsButton.setMenuDefinition(f);this.fsButton.createMenu();this.showFilterSearchMenu();b.query("#sfm1",this.fsButton.menu.domNode).addClass("wsMenuItemDefault")}else this.hideFilterSearchMenu()},filterSearch:function(a,c){c?this.model.subSearch(c):this.model.search(this.model.getSearchString(),this.model.getSearchIn());b.query(".wsMenuItem",this.fsButton.menu.domNode).removeClass("wsMenuItemDefault");b.query("#"+a,this.fsButton.menu.domNode).addClass("wsMenuItemDefault")},
addItem:function(a,c,b,e){a[c]?a[c].cnt++:a[c]={cnt:1,fn:b,n:e}},openPremiumSettings:function(){ws.WebSuite.openSettings("premiumSettings")},getForwardingInfo:function(){ws.io.rpc({action:"ForwardAction",content:{forwardAction:"Get"},load:b.hitch(this,function(a){if(a.isSuccess)ws.WebSuite.mailForwardingRPCMade=!0,ws.WebSuite.mailForwardingEmail=a.email,ws.WebSuite.mailForwardingLocalCopy=a.localCopy,this.updateForwardingInfo()}),error:function(){}})},updateForwardingInfo:function(){if(Config.MFMsgListEnabled&&
Config.EnablePremiumSettings&&0<Settings.MailboxTier.length&&!this.searchInfoPane.isShowing())ws.WebSuite.mailForwardingRPCMade?(ws.WebSuite.mailForwardingEmail&&0<ws.WebSuite.mailForwardingEmail.length?(this.forwardingInfoNode.innerHTML=ws.string.substituteParams(Config.Strings.PremiumForwardingOn,ws.WebSuite.mailForwardingEmail),this.forwardingInfoPane.show()):this.forwardingInfoPane.hide(),this.layoutWidget.layout()):this.getForwardingInfo()},onFilterMenu:function(a,c,b){this.model.setFilter(a,
c,b);ws.reporting.report("Filter Messages - "+a,"Mail")},updateFilterButton:function(){var a=this.model.filter,c=this.model.getRowCount(),b={all:Config.Strings.FilterAll,unread:Config.Strings.FilterUnread,read:Config.Strings.FilterRead,flagged:Config.Strings.FilterFlagged,unflagged:Config.Strings.FilterUnflagged,answered:Config.Strings.FilterAnswered,unanswered:Config.Strings.FilterUnanswered,tag:Config.Strings.FilterIdentity},e="",e="tag"==a?e+ws.string.substituteParams(b[a],c,this.model.identity):
e+ws.string.substituteParams(b[a],c);this.filterButton.setLabel(e);"none"!=this.domNode.style.display&&this.toolbar.layout()},updateActionMenu:function(){var a=this.actionButton.menu;if(a){var c=a.getChildren();if(!("initialChildCount"in a))a.initialChildCount=c.length;var d=this.model.getCurrentFolder().type,e="Drafts"!=d&&"Deleted"!=d&&this.model.canChangeMessageReadState(),f=0<this.model.getFoldersCanMoveTo().length,i="Drafts"!=d&&("ANGELIA"==ws.UserContext.MailboxType?Config.ShowMessageStatus&&
Config.UseOMS:Config.ShowMessageStatus),d="Drafts"!=d&&"Sent"!=d&&Config.EnableFiltersSettings;c[0].setCaption(Settings.ViewNewOld?Config.Strings.KeepAsNewActionLabel:Config.Strings.MarkUnreadActionLabel);c[0].setShowing(e);c[1].setShowing(e);c[2].setShowing(e);c[3].setShowing(!0);c[4].setShowing(!0);c[5].setShowing(!0);c[6].setShowing(d);c[7].onClick=b.hitch(this,"onClickShowStatus",this.model.currentFolder);c[7].setShowing(i);c[8].setShowing(f&&i);if(!a.foldersDone)this.updateActionMenuFolders(),
a.foldersDone=!0}},updateActionMenuFolders:function(){var a=this.actionButton.menu;if(a){for(var c=a.getChildren(),d,e=0<this.model.getFoldersCanMoveTo().length,f=c.length-1;f>=a.initialChildCount;f--)d=c[f],a.removeChild(d),d!=this.newFolderSeparator&&d!=this.newFolderMenu&&d!=this.newFolderInputMenu&&d.destroyRecursive();if(e){d=new m({caption:Config.Strings.MoveActionLabel,isLabel:!0});d.setShowing(e);a.addChild(d);b.forEach(this.model.folders,b.hitch(this,function(c){if(-1!=b.indexOf(this.model.getFoldersCanMoveTo(),
c.name)){var f=this.getDisplayName(c);d=new m({caption:f});d.onClick=b.hitch(this,"moveMessages",c.name,c.displayName);a.addChild(d);d.startup()}}));if(!this.newFolderSeparator)this.newFolderSeparator=new n,this.newFolderSeparator.startup(),this.newFolderMenu=new m({caption:Config.Strings.NewFolder}),this.newFolderMenu._onClick=b.hitch(this,"newFolder"),this.newFolderMenu.startup();a.addChild(this.newFolderSeparator);a.addChild(this.newFolderMenu);if(!a._setAboutToShow)a.aboutToShow=b.hitch(this,
function(){if(this.newFolderInputMenu){var a=this.actionButton.menu;if(a)a._setAboutToShow=!0;this.newFolderInputMenu.restore()}})}}},filterMenuMap:{all:0,unread:2,read:3,flagged:5,unflagged:6},updateFilterMenu:function(){var a=this.filterButton.menu;if(a){var c=a.getChildren();if(!("initialChildCount"in a))a.initialChildCount=c.length;var b=this.filterMenuMap[this.model.filter];null!=b&&a.setChecked([b],!0);b="Drafts"!=this.model.getCurrentFolder().type;c[this.filterMenuMap.unread].setShowing(b);
c[this.filterMenuMap.read].setShowing(b);c[4].setShowing(b);for(b=c.length-1;b>=a.initialChildCount;b--)a.removeChild(c[b])}},getDisplayName:function(a){var c=a.displayName,b=Config.ImapStoreFolderDepthStartAt;if(Config.EnableIMAPFolderHierarchy){var c=Config.FolderHierarchyDelimiter,e="",f;for(f=b;f<a.depth;f++)e+="&nbsp;";for(f=b;f<a.depth;f++)e+=c;c=e+a.displayName}return ws.string.escapeXml(c)},checkNullUid:function(a,c,b){if(ws.lang.undefinedOrNull(c)){var c=this.model.getUidForRow(b),b=this.model.getRowData(b),
e="";window.ws_ErrLgr&&(e=ws.lang.undefinedOrNull(c)?"index":ws.lang.undefinedOrNull(b)?"row":"rowData",ws_ErrLgr.logError(ws_ErrLgr.cat.ProgErr,a+" got null uid ("+e+"): file:MessageListView.js"));return!1}return!0},handleCellClick:function(a){if(ws.WebSuite.isRecordTimingData)ws.WebSuite.messageReadTimerStart=new Date;if(b.isWebKit)try{window.focus()}catch(c){}var d=this.model.getDatum(a.rowIndex,this.model.columns.UID);if(this.checkNullUid("handleCellClick",d,a.rowIndex)){var e=!this.model.getDatum(a.rowIndex,
this.model.columns.Flag),f=null;Config.UseOMS&&Config.CrossFolderSearch&&(f=this.model.getDatum(a.rowIndex,this.model.columns.Folder));switch(a.cellIndex){case this.gridModel.columns.Flag:this.model.flagMessages({uids:[d],load:function(){e?b.publish("WSFeedbackStart",[Config.Strings.MessageFlagged,!0]):b.publish("WSFeedbackStart",[Config.Strings.MessageUnflagged,!0])},flag:e});break;default:var a=a.timeStamp?a.timeStamp:(new Date).getTime(),i=Settings.ReadInPopup?2500:500;if(this.lastClickUid==d&&
a-this.lastClickTime<i){this.lastClickUid=d;ws.WebSuite.lastReadPopUp&&ws.WebSuite.lastReadPopUp.focus();break}this.lastClickTime=a;this.lastClickUid=d;7>=b.isIE&&Settings.ReadInPopup?ws.lang.setTimeout(this,"openMessage",300,d,!1,!1,!1,!1,f,!0):this.openMessage(d,!1,!1,!1,!1,f,!0)}}},handleCellDblClick:function(a){ws.html.clearSelection();var c=this.model.getDatum(a.rowIndex,this.model.columns.UID);if(this.checkNullUid("handleCellDblClick",c,a.rowIndex)&&(Settings.EnablePreviewPane||!Settings.PreviewPaneIntroSeen)&&
Settings.PreviewPaneVisible){var b=null;Config.UseOMS&&Config.CrossFolderSearch&&(b=this.model.getDatum(a.rowIndex,this.model.columns.Folder));this.openMessage(c,!1,!0,!1,!1,b)}},openMessage:function(a,c,d,e,f,i,g){ws.WebSuite.lastReadPopUp=null;var h=!1;if(i)h="Drafts"==i;else if(this.model.getCurrentFolder())h="Drafts"==this.model.getCurrentFolder().type,i=this.model.getCurrentFolder().name;var k=this.model.screenName;if(this.previewPane)this.previewPane.skipPreviewReporting=d;(Settings.EnablePreviewPane||
!Settings.PreviewPaneIntroSeen)&&Settings.PreviewPaneVisible&&!d&&!c?this.previewMessage(a,e,f,!1,i,g):(d=this.model.getSelectedUids(),(this.model.allSelected||1<d.length)&&this.model.deselectAll(),h?this.getComposeCB(b.hitch(this,function(b){b.openDraft(this.model.currentFolder,a)}),c):this.openMessageCB&&this.openMessageCB(i,a,c,k))},checkMessageReadState:function(a,b){this.model.checkMessageReadState(null,{folder:a,uid:b})},previewMessage:function(a,c,d,e,f,i){ws.lang.ensureLayersLoadedExtra(b.hitch(this,
function(){try{b.isWebKit||this.grid.views.views[0].focus()}catch(g){}var h=this.model.getSelectedUids();(this.model.allSelected||1<h.length)&&this.model.deselectAll();ws.lang.setTimeout(this,function(){this.model.setCurrentUid(a)},b.isFF&&i?500:0);null==this.prevPaneDelayTimeoutId?(this.__previewMessage(a,c,d,e,f),this.prevPaneDelayTimeoutId=ws.lang.setTimeout(this,function(){this.prevPaneDelayTimeoutId=null},500)):(clearTimeout(this.prevPaneDelayTimeoutId),this.prevPaneDelayTimeoutId=ws.lang.setTimeout(this,
"__previewMessage",500,a,c,d,e,f))}),{layers:["DisplayMessage"]})},__previewMessage:function(a,c,d,e,f){require(["ws/mail/DisplayMessageWidget"],b.hitch(this,function(b){this.prevPaneDelayTimeoutId=null;this.createPreviewPane(b);this.previewPane.displayMessage(f||this.model.currentFolder,a,null,!1,!0,d);Settings.PreviewPaneIntroSeen||this.savePreviewPaneSettings({PreviewPaneIntroSeen:!0,EnablePreviewPane:!0})}))},setCurrentRow:function(a){var b=this.model.getUidForRow(a),d=null;Config.UseOMS&&Config.CrossFolderSearch&&
(d=this.model.getDatum(a,this.model.columns.Folder));b&&this.previewMessage(b,!1,!1,!1,d)},maybePreviewNextMessage:function(a,b,d){this.previewPane&&a&&1==a.length&&(b?(this.model.checkMessageLocal(this.model.currentFolder,b)&&d&&(this.previewPane.previewPaneUidBucket[b]=!0),this.previewMessage(b)):this.model.currentUid==a[0]&&this.previewMessage(this.previewPane.getNextUid()))},onSelectionChange:function(a){var b=this.model.getSelectedUids().length;b&&this.model.setCurrentUid(null);b=this.getPreviewPaneBody(b,
a);if(this.previewPane&&(!this.model.currentUid||a))this.previewPane.showBodyPrompt(b);else if(this.fakePreviewPane)this.fakePreviewPane.domNode.innerHTML="<div>"+b+"</div>";this.updateHeader()},onSplitterClick:function(){var a=this.fakePreviewPane||this.previewPane;if(a)0==a.sizeShare?(this.openPreviewPane(),b.query(".dijitSplitContainerSizerV",this.domNode)[0].title=Config.Strings.SplitterTipClose):(this.closePreviewPane(),ws.html.clearSelection(),b.query(".dijitSplitContainerSizerV",this.domNode)[0].title=
Config.Strings.SplitterTipOpen)},openPreviewPane:function(){var a=this.fakePreviewPane||this.previewPane;if(a){a.sizeMin=70;if(0>=Settings.PreviewPaneHeight||100<Settings.PreviewPaneHeight)Settings.PreviewPaneHeight=50;a.sizeShare=Settings.PreviewPaneHeight;this.layoutWidget.sizeShare=100-Settings.PreviewPaneHeight;this.splitContainer._forceGrow=!0;this.splitContainer.layout();this.splitContainer._forceGrow=!1;this.savePreviewPaneSettings({PreviewPaneVisible:!0});ws.WebSuite.previewPaneToLastReadMsg(this);
b.query(".dijitSplitContainerSizerV .thumb",this.domNode).removeClass("openThumb")}},closePreviewPane:function(){this._closePreviewPane();this.savePreviewPaneSettings({PreviewPaneVisible:!1})},_closePreviewPane:function(){this.model.setCurrentUid(null);var a=this.fakePreviewPane||this.previewPane;if(a)a.sizeMin=a.sizeShare=0,this.splitContainer.layout(),b.query(".dijitSplitContainerSizerV .thumb",this.domNode).addClass("openThumb"),b.query(".dijitSplitContainerSizerV",this.domNode)[0].title=Config.Strings.SplitterTipOpen},
setPreviewPaneEnabled:function(a){if(a)this.createFakePreviewPane(),this.onSelectionChange();else{var c=this.fakePreviewPane||this.previewPane;if(c){try{this.splitContainer.removeChild(c),c.destroyRecursive()}catch(d){j.registry.remove(c.id)}this.fakePreviewPane=this.previewPane=null;if(b.isIE)this.layoutWidget.domNode.style.zoom="1",this.layoutWidget.domNode.style.zoom="",this.layoutWidget.resize()}this.model.setCurrentUid(null)}this.customizeButton.menu.getChildren()[8].setChecked(a);this.updateToolbarState()},
togglePreviewPane:function(){var a=!(Settings.EnablePreviewPane||!Settings.PreviewPaneIntroSeen);Settings.PreviewPaneIntroSeen?this.savePreviewPaneSettings({EnablePreviewPane:a}):this.savePreviewPaneSettings({EnablePreviewPane:a,PreviewPaneIntroSeen:!0});this.setPreviewPaneEnabled(a)},showPreviewPane:function(){var a={EnablePreviewPane:!0};if(!Settings.PreviewPaneIntroSeen)a.PreviewPaneIntroSeen=!0;this.savePreviewPaneSettings(a);this.setPreviewPaneEnabled(!0)},hidePreviewPane:function(){var a={EnablePreviewPane:!1};
if(!Settings.PreviewPaneIntroSeen)a.PreviewPaneIntroSeen=!0;this.savePreviewPaneSettings(a);this.setPreviewPaneEnabled(!1)},setSpacing:function(a){if("undefined"!=typeof a){var c=ws.WebSuite.heightMode;if(ws.WebSuite.isAutoSpacingEnabled&&0!=a||a!=c){var d=this.customizeButton.menu;d.setChecked([a+1]);d.setUnchecked([(ws.WebSuite.isAutoSpacingEnabled&&0!=a?0:c)+1]);ws.WebSuite.isAutoSpacingEnabled=0==a;Settings.ListSpacingType=a;ws.settings.saveSoon({ListSpacingType:a});ws.WebSuite.isAutoSpacingEnabled&&
(a=ws.WebSuite.getAutoSpacingType());ws.WebSuite.heightMode=a;b.removeClass(b.body(),"spacing"+c);b.addClass(b.body(),"spacing"+a);b.publish(["ListSpacingResize"])}}},toggleButtonLabels:function(){if(b.hasClass(b.body(),"btnLabelsOn2")){var a=!1;Settings.ToolbarButtonType=3;b.removeClass(b.body(),"btnLabelsOn2")}else a=!0,Settings.ToolbarButtonType=2,b.addClass(b.body(),"btnLabelsOn2");ws.settings.saveSoon({ToolbarButtonType:Settings.ToolbarButtonType});this.customizeButton.menu.getChildren()[11].setChecked(a);
b.publish("toolbarLayoutUpdate")},savePreviewPaneSettings:function(a){if(a){if("undefined"!=typeof a.EnablePreviewPane&&!a.EnablePreviewPane)a.PreviewPaneHeight=50,a.PreviewPaneVisible=!0;for(var b in a)Settings[b]=a[b];ws.settings.saveSoon(a)}},getPreviewPaneBody:function(a,c){var d="",e=this.model.isAllInViewSelected(),f=this.model.getOpSize();if(0==a)a=f.opSize;if(a||e)e=1==a?Config.Strings.PreviewPane_OneSelected:e?Config.Strings.PreviewPane_AllSelected:ws.string.substituteParams(Config.Strings.PreviewPane_NSelected,
a),d=d+("<div class='PreviewPane_emptyTipHeader'>"+e+"</div>")+('<div class="PreviewPane_tipIcon"><img src="'+Config.SpacerImageURL+'"></div>'),d+=ws.string.substituteParams("<div class='PreviewPane_tip'><span class='tipPrefix'>{0}</span> {1}</div>",Config.Strings.PreviewPane_Tip,Config.Strings.PreviewPane_SelectedTipMsg1);else if(0==this.model.getRowCount()&&Settings.PreviewPaneIntroSeen&&!c)d="";else if(Settings.PreviewPaneIntroSeen){if(!this._previewPaneEmptyMsgCount){e=1;for(f=this.model.getFolderByType("Deleted").displayName;Config.Strings["PreviewPane_EmptyTipMsg"+
e];)e++;Config.Strings.PreviewPane_EmptyTipMsg3=ws.string.substituteParams(Config.Strings.PreviewPane_EmptyTipMsg3,f);Config.Strings.PreviewPane_EmptyTipMsg1=ws.string.substituteParams(Config.Strings.PreviewPane_EmptyTipMsg1,"<span class='wsLink' onclick='ws.WebSuite.openSettings()'>","</span>");this._previewPaneEmptyMsgCount=e-1;this._lastEmptyMsgRotate=0;this._lastEmptyMsgR=1}if(this._previewPaneEmptyMsgCount){e=(new Date).getTime();if(2E3>e-this._lastEmptyMsgRotate)f=this._lastEmptyMsgR;else{f=
Math.floor(Math.random()*this._previewPaneEmptyMsgCount)+1;if(f>this._previewPaneEmptyMsgCount)f=this._previewPaneEmptyMsgCount;this._lastEmptyMsgRotate=e;this._lastEmptyMsgR=f}d+="<div class='PreviewPane_emptyTipHeader'>"+Config.Strings.PreviewPane_EmptyTipHeader+"</div>";d+='<div class="PreviewPane_tipIcon"><img src="'+Config.SpacerImageURL+'"></div>';d+=ws.string.substituteParams("<div class='PreviewPane_tip'><span class='tipPrefix'>{0}</span> {1}</div>",Config.Strings.PreviewPane_Tip,Config.Strings["PreviewPane_EmptyTipMsg"+
f])}}else d="<div class='PreviewPane_introTip'><div class='PreviewPane_introTipHeader'>"+Config.Strings.PreviewPane_IntroHeader+"</div>",d+="<div class='PreviewPane_offPreviewPane'>"+Config.Strings.PreviewPane_NoThanks+" <span class='wsLink' onclick='if(ws.WebSuite&&ws.WebSuite.msgLstTogglePreviewPane)ws.WebSuite.msgLstTogglePreviewPane()'>"+Config.Strings.PreviewPane_Off+"</span></div>",ws.WebSuite.msgLstTogglePreviewPane=b.hitch(this,"togglePreviewPane");return d},createFakePreviewPane:function(){if(!this.fakePreviewPane&&
!this.previewPane){var a=new t;a.domNode.className="fakePreviewPane";a.domNode.style.width="0px";a.domNode.style.height="0px";var b=this.getPreviewPaneBody();a.domNode.innerHTML="<div>"+b+"</div>";this.addPreviewPane(a);ws.WebSuite.SidePanel.setupAdScroll(a.domNode,"preview")}},createPreviewPane:function(a){if(!this.previewPane){var c={id:"previewPane",model:this.model,getComposeCB:this.getComposeCB,backToListCB:b.hitch(this,function(){}),getAddEditWidgetCB:b.hitch(ws.WebSuite,"getAddEditWidget"),
showFullMessageCB:b.hitch(this,"openMessageCB"),showFullMessageLink:!0,showNewWindowLink:!1,calendarModel:ws.WebSuite.theCalendarModel,beaconSuffix:"Preview Pane",showToolbar:!1,enableKeyboardShortcuts:!1,isPreviewPane:!0};this.previewPane=new a(c);this.previewPane._presenceResponse=b.hitch(this,"_presenceResponse");this.previewPane.show();this.pPaneConctors=[];this.pPaneConctors.push(b.connect(this.previewPane,"messageReceived",this,"updateToolbarState"));this.pPaneConctors.push(b.connect(this.model,
"preUpdateExistingDraft",this,"preSaveMessage"));this.addPreviewPane(this.previewPane)}},preSaveMessage:function(a,b){if(a&&this.previewPane){var d="Drafts"==this.model.getCurrentFolder().type,e=a==this.previewPane.uid,e=e&&this.previewPane.uid==this.model.currentUid;d&&e&&this.previewPane.isShowing()&&b&&this.previewMessage(b,!0,!0)}},_presenceResponse:function(a){200==a.response.statusCode&&(ws.widget.updateIMButton(this.comboIMButton,a.response.data.users,"messageList"),this.toolbar.layout())},
addPreviewPane:function(a){if(0>=Settings.PreviewPaneHeight||100<Settings.PreviewPaneHeight)Settings.PreviewPaneHeight=50;this.layoutWidget.sizeShare=100-Settings.PreviewPaneHeight;a.sizeShare=Settings.PreviewPaneHeight;a.collapsable=!0;if(this.fakePreviewPane)j.layout._LayoutWidget.prototype.removeChild.apply(this.splitContainer,[this.fakePreviewPane]),j.layout._LayoutWidget.prototype.addChild.apply(this.splitContainer,[a]),this.splitContainer._setupChild(a),this.isShowing()&&this.splitContainer.layout(),
this.fakePreviewPane=null;else if(this.splitContainer.addChild(a),this.splitContainer.addClickFunc(b.hitch(this,"onSplitterClick")),b.query(".dijitSplitContainerSizerV",this.domNode)[0].title=Config.Strings.SplitterTipClose,a!=this.previewPane)this.fakePreviewPane=a;Settings.PreviewPaneVisible||this._closePreviewPane();ws.lang.setTimeout(this,"setPreviewPaneMinSize",0)},setPreviewPaneMinSize:function(){var a=this.previewPane||this.fakePreviewPane;if(a){if(0<this.domNode.offsetHeight){var c=b._getMarginSize(this.toolbar.domNode).h,
d=b._getMarginSize(this.notification.domNode).h,e=b._getMarginSize(this.searchInfoPane.domNode).h+b._getMarginSize(this.forwardingInfoPane.domNode).h;this.layoutWidget.sizeMin=c+d+e+66;a.sizeMin=70}0==a.coords.h?b.query(".dijitSplitContainerSizerV",this.domNode)[0].title=Config.Strings.SplitterTipOpen:b.query(".dijitSplitContainerSizerV",this.domNode)[0].title=Config.Strings.SplitterTipClose}},initSplitContainer:function(){b.connect(this.splitContainer,"layout",this,"setPreviewPaneMinSize");b.connect(this.splitContainer,
"beginSizing",b.hitch(this,function(){this.beginSizingFrom0=0==(this.fakePreviewPane||this.previewPane).sizeActual?!0:!1}));b.connect(this.splitContainer,"endSizing",b.hitch(this,function(){var a=this.fakePreviewPane||this.previewPane,b=Math.round(100*(a.sizeActual/(this.layoutWidget.sizeActual+a.sizeActual)));if(this.beginSizingFrom0&&0<a.sizeActual){if(0>b||100<b)b=50;this.savePreviewPaneSettings({PreviewPaneHeight:b,PreviewPaneVisible:!0});ws.WebSuite.previewPaneToLastReadMsg(this)}!this.beginSizingFrom0&&
0==a.sizeActual&&(this.savePreviewPaneSettings({PreviewPaneVisible:!1}),this.model.setCurrentUid(null))}))},restartIM:function(){this.previewPane&&this.previewPane.restartIM()},reply:function(){this._respond("reply")},replyAll:function(){this._respond("replyAll")},forward:function(){this._respond("forward")},_respond:function(a,c,d){(c=this.getMessageActionUids(c))&&1==c.length?(d&&d.preventDefault(),this.previewPane&&c[0]==this.model.currentUid?this.previewPane.composeResponse(a):this.getComposeCB(b.hitch(this,
function(b){b.fetchAndRespond(this.model.currentFolder,c[0],a)}))):1<c.length?ws.widget.Dialogs.ok(Config.Strings.TooManyMsgSelected):this.model.deselectAll()},savePreviewPaneSelection:function(){this.previewPane&&this.previewPane.saveSelection()},viewMessageSource:function(a,b){var d=ws.string.substituteParams("%{0}viewSource?user=%{1}&uid=%{2}",Config.BaseJASUrl,encodeURIComponent(ws.io.getUserUid()),encodeURIComponent(b));ws.io.openWindow(d,"","status=yes,resizable=yes,menubar=yes,scrollbars=yes");
ws.reporting.report("Message Source","Mail")},deleteMessages:function(a,c,d){var e=this.model.isAllSelected();a&&a.length&&(e=!1);var f=null!=this.model.getSearchString();if(!e&&(a=this.getMessageActionUids(a,!1,!0),!a))return;if("Deleted"==this.model.getCurrentFolder().type||"Spam"==this.model.getCurrentFolder().type)this.model.isAllSelReal()&&ws.reporting.reportDLAction("Mail-MessageList-SelectAll-DeleteSpamTrash"),ws.widget.Dialogs.okCancel(Config.Strings.PermDeleteSelectedConfirmation,b.hitch(this,
function(b){b&&this._deleteMessages(a,null,!1,d,f?!1:e)}));else{var i=this.model.getSelectedUids().length;if(0==i)i=this.model.getOpSize().opSize;var g=this.model.isAllSelReal()&&1<i;!c&&(g||i>Config.DeleteMessageWarningCount)?(this.model.isAllSelReal()?ws.reporting.reportDLAction("Mail-MessageList-SelectAll-Delete"):ws.reporting.reportDLAction("Mail-MessageList-Delete15Plus"),ws.widget.Dialogs.okCancel(ws.string.substituteParams(Config.Strings.DeleteNumMessages,i),b.hitch(this,function(b){b&&this._deleteMessages(a,
null,!0,d,f?!1:e)}))):this._deleteMessages(a,null,!1,d,f?!1:e)}},_deleteMessages:function(a,c,d,e,f){var i="",g=this.model.getOpSize(a),i=!c||"string"!=typeof c?1==g.opSize?Config.Strings.MessageDeleted:f&&!g.havexuids?Config.Strings.MessagesDeletedAll:ws.string.substituteParams(Config.Strings.MessagesDeleted,g.opSize):1==g.opSize?ws.string.substituteParams(Config.Strings.MessageMoved,c):f&&!g.havexuids?ws.string.substituteParams(Config.Strings.MessagesMovedAll,c):ws.string.substituteParams(Config.Strings.MessagesMoved,
g.opSize,c);e||(e="unknown");if(!a||!(1==a.length&&this.model.currentUid&&this.model.currentUid!=a[0]))c=this.model.getAdjacentMessageUid(this.model.currentUid,1),this.model.setCurrentUid(c),window.clearTimeout(this._previewTO),this._previewTO=window.setTimeout(b.hitch(this,"maybePreviewNextMessage",a,c,!0),100);this.model.deleteMessages({uids:a,reason:e,checkUndo:!0,isAllSel:f,load:b.hitch(this,function(a){var c=null;!Config.UseOMS&&(Config.EnableRestoreButton||Settings.ViewNewOld)&&a.responseUIDs?
c=a.canUndo?b.hitch(this.model,"undoRestoreMessages",a.responseUIDs):null:a.responseUIDs&&(c=a.canUndo?b.hitch(this.model,"undoMoveMessages",a.responseUIDs,Config.DeletedItemsFolderName):null);d&&(c=null);f&&(this.model.activeCachedList.Clear({preserveSort:!0}),this.model.setFolder(this.model.getCurrentFolder().name,null,null,null,null,"descending",!0));ws.lang.setTimeout(this,function(){b.publish("WSFeedbackStart",[i,!0,c])},200)}),error:function(a){window.ws_ErrLgr&&!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.UserVisErr,
"Dialogs.ok shown - Error Handler for model.deleteMessages-_deleteMessages file:MessageListView.js");ws.widget.Dialogs.ok(a||Config.Strings.ErrorDeleting)}})},onClickDelete:function(){this.deleteMessages(null,!1,"delebtn")},restoreMessages:function(a){if(a=this.getMessageActionUids(a)){this.maybePreviewNextMessage(a);var c=this.model.getOpSize(a);this.model.restoreMessages({uids:a,folder:Config.DeletedItemsFolderName,load:b.hitch(this,function(){this.model.refetchFolderIndex(this.model.currentFolder);
var a=1==c.opSize?Config.Strings.MessageRestored:this.model.isAllSelected()&&!c.havexuids?Config.Strings.MessagesRestoredAll:ws.string.substituteParams(Config.Strings.MessagesRestored,c.opSize);b.publish("WSFeedbackStart",[a,!0])}),error:function(a){window.ws_ErrLgr&&!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.UserVisErr,"Dialogs.ok shown - Error Handler for model.restoreMessages-restoreMessages file:MessageListView.js");ws.widget.Dialogs.ok(a||Config.Strings.ErrorRestoring)}})}},onClickRestore:function(){this.restoreMessages()},
moveMessages:function(a,c){var d=null!=this.model.getSearchString()?!1:this.model.isAllSelected(),e=this.getMessageActionUids(null);if(e){var f=this.model.getOpSize(e);"Deleted"!=this.model.getCurrentFolder().type&&a==Config.DeletedItemsFolderName?this._deleteMessages(e,c,!1,"movtrsh",d):a==Config.SpamFolderName?this.spamAction(!0,e):(this.maybePreviewNextMessage(e),this.model.moveMessages({uids:e,destFolder:a,checkUndo:!0,isAllSel:d,load:b.hitch(this,function(e){var g=null;e.canUndo&&e.responseUIDs&&
!ws.lang.isEmptyObject(e.responseUIDs)&&!d&&(g=b.hitch(this.model,"undoMoveMessages",e.responseUIDs,a));1==f.opSize?b.publish("WSFeedbackStart",[ws.string.substituteParams(Config.Strings.MessageMoved,c),!0,g]):d&&!f.havexuids?b.publish("WSFeedbackStart",[ws.string.substituteParams(Config.Strings.MessagesMovedAll,c),!0,g]):b.publish("WSFeedbackStart",[ws.string.substituteParams(Config.Strings.MessagesMoved,f.opSize,c),!0,g]);if(d)this.model.allSelected=!1,this.model.activeCachedList.Clear({preserveSort:!0}),
this.model.setFolder(this.model.getCurrentFolder().name,null,null,null,null,"descending",!0)}),error:function(a){window.ws_ErrLgr&&!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.UserVisErr,"Dialogs.ok shown - Error Handler for model.moveMessages-moveMessages file:MessageListView.js");ws.widget.Dialogs.ok(a||Config.Strings.MoveMessageError)}}))}},moveToNewFolder:function(a){if(a&&a.newName){var c=b.hitch(this,"moveMessages");this.model.createFolder({newName:a.newName,load:b.hitch(this,function(d){b.publish("WSFeedbackStart",
[Config.Strings.FolderCreated,!0]);c("ANGELIA"==ws.UserContext.MailboxType?d.iName:Config.NewFolderPrefix+a.newName,a.newName)}),error:function(b){window.ws_ErrLgr&&!b&&ws_ErrLgr.logError(ws_ErrLgr.cat.UserVisErr,"Dialogs.ok shown - Error Handler for model.createFolder-moveToNewFolder file:MessageListView.js");ws.widget.Dialogs.ok(b?b:ws.string.substituteParams(Config.Strings.ErrorCreatingFolder,a.newName))}})}},newFolder:function(a){a&&a.stopPropagation();require(["ws/widget/WSInputableMenuItem"],
b.hitch(this,function(a){var d=this.actionButton.menu;if(d){this.newFolderMenu.hide();if(!this.newFolderInputMenu)this.newFolderInputMenu=new a({okCB:b.hitch(this,"moveToNewFolder"),defaultValue:Config.Strings.NewFolder,originalMenuItem:this.newFolderMenu,maxlength:ws.mail.folderName.MaxLength});ws.lang.setTimeout(this,function(){d.addChild(this.newFolderInputMenu);this.newFolderInputMenu.show();this.newFolderInputMenu.initializeText(Config.Strings.NewFolder);g.scrollIntoView(this.newFolderInputMenu.domNode)},
0)}}))},reportNotSpam:function(){this.spamAction(!1)},reportSpam:function(){this.spamAction(!0)},spamAction:function(a,c){var d=b.hitch(this,function(d,f,e,g,i){if(c){var h=this.model.getAdjacentMessageUid(this.model.currentUid,1);this.model.setCurrentUid(h);window.clearTimeout(this._previewTO);this._previewTO=window.setTimeout(b.hitch(this,"maybePreviewNextMessage",c,h,!0),100);var j=this.model.getOpSize(c),k=this.model.isAllSelected();this.model.reportSpamMessages({checkUndo:a&&!e,uids:c,isSpam:a,
unsubscribe:e?e:null,load:b.hitch(this,function(c){var h=b.hitch(this,function(d,h,j){if(a)if(c._showSpamOffAlert&&!e)d=1==h.opSize?Settings&&"Off"==Settings.PersonalAdaptiveSpamFilterLevel?e?ws.string.substituteParams(Config.Strings.UnsubConfirm,null!=i?i:g):Config.Strings.MessageMarkedSpam:Config.Strings.SD_spamfltroffMrkSpmFdbk:Settings&&"Off"==Settings.PersonalAdaptiveSpamFilterLevel?ws.string.substituteParams(Config.Strings.MessagesMarkedSpam,h.opSize):ws.string.substituteParams(Config.Strings.SD_spamfltroffMrkSpmManyFdbk,
h.opSize),b.publish("WSFeedbackStart",[ws.string.unescapeXml(d),!0,null]);else{var k;k=this.model.isInboxNewOld(this.model.currentFolder)?b.hitch(this.model,"undoReportSpamMessages",d.responseUIDs):b.hitch(this.model,"undoMoveMessages",d.responseUIDs,Config.SpamFolderName);undoCallback=d.canUndo?k:null;d=1==h.opSize?e?ws.string.substituteParams(Config.Strings.UnsubConfirm,null!=i?i:g):Config.Strings.MessageMarkedSpam:j&&!h.havexuids?Config.Strings.MessagesMarkedSpamAll:ws.string.substituteParams(Config.Strings.MessagesMarkedSpam,
h.opSize);b.publish("WSFeedbackStart",[ws.string.unescapeXml(d),!0,undoCallback])}else d=1==h.opSize?f&&"userrule"===l?Config.Strings.SD_fltrDelFdbk:f?Config.Strings.SD_stngChgdFdbk:Config.Strings.MessageMarkedNotSpam:j&&!h.havexuids?Config.Strings.MessagesMarkedNotSpamAll:ws.string.substituteParams(Config.Strings.MessagesMarkedNotSpam,h.opSize),b.publish("WSFeedbackStart",[ws.string.unescapeXml(d),!0,null])},c,j,k);c._showSpamOffAlert&&"nonSDdlg"===d?ws.widget.Dialogs.showSpamOffAlert(h):h()}),error:function(a){window.ws_ErrLgr&&
!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.UserVisErr,"Dialogs.ok shown - Error Handler for model.reportSpamMessages-spamAction file:MessageListView.js");ws.widget.Dialogs.ok((e?ws.string.substituteParams(Config.Strings.UnsubError,null!=i?i:g):a)||Config.Strings.ReportSpamError)}})}}),c=this.getMessageActionUids(c);if(!c.length&&this.model.allSelected){var e=this.model.activeCachedList.data.index.length;if(1===e)c=[this.model.activeCachedList.data.index[0]];else if(!ws.lang.isEmptyObject(this.model.exclUids)&&
1===e-ws.lang.getPropCount(this.model.exclUids))for(var f=this.model.activeCachedList.data.index,e=0;e<f.length;e++)if(!this.model.exclUids[parseInt(f[e])]){c=[f[e]];break}}e=null;1===c.length&&(e=this.model.getUidData(c[0]));if(a&&null!=e&&Settings.EnableUnsubscribing&&e[this.model.columns.canUnsubscribe]){var g=e[this.model.columns.FromToAddress]||Config.Strings.None,f=null;Config.UseOMS&&Config.FriendlyName&&null!=e[this.model.columns.Description]&&""!=e[this.model.columns.Description]&&!0==Settings.ShowSenderDisplayName&&
(f=ws.string.escapeXml(e[this.model.columns.Description]));ws.widget.Dialogs.showUnsubDialog(c,g,f,d)}else if(Settings.UserHash>=Config.SpamDispositionThreshold){var f={},h=!0;if(1>=c.length)for(e=0;e<c.length;e++){var j=this.model.getUidData(c[e]),k=ws.WebSuite.spmGetDetailFromCode(j[this.model.columns.spamReason]),g="Spam"===this.model.currentFolder,l=ws.WebSuite.spamReasonUpdater(k.reason,g,j[this.model.columns.isSpam],this.model),k=k.detail;""===k&&"permitlist"===l&&""!==j[this.model.columns.FromToAddress]&&
(k=j[this.model.columns.FromToAddress]);if(ws.WebSuite.spamReasonShouldBeShown(l,g)){if("spamfltroff"===l){f={};break}f[l]?""!==k&&-1===f[l].indexOf(k)&&f[l].push(k):f[l]=""!==k?[k]:[]}else h=!1}ws.lang.isEmptyObject(f)?d("nonSDdlg"):ws.widget.Dialogs.showSpamDisp(f,c,h,g,d)}else d("nonSDdlg")},markMessagesRead:function(){this.changeMessagesReadState(!0)},markMessagesUnread:function(){this.changeMessagesReadState(!1)},changeMessagesReadState:function(a,c){if(c=this.getMessageActionUids(c)){var d=
this.model.getCurrentFolder().type;(a&&Config.EnableMoveForMarkSeen&&"NewMail"==d||!a&&Config.EnableMoveForMarkUnseen&&"OldMail"==d)&&this.maybePreviewNextMessage(c);var e=this.model.getOpSize(c),f=this.model.isAllSelected();this.model.changeMessagesReadState({uids:c,read:a,load:b.hitch(this,function(){var c="",c=1==e.opSize?a?Config.Strings.MessageMarkedRead:Config.Strings.MessageMarkedNew:f&&!e.havexuids?a?Config.Strings.MessagesMarkedReadAll:Config.Strings.MessagesMarkedNewAll:ws.string.substituteParams(a?
Config.Strings.MessagesMarkedRead:Config.Strings.MessagesMarkedNew,e.opSize);b.publish("WSFeedbackStart",[c,!0])}),error:function(a){window.ws_ErrLgr&&!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.UserVisErr,"Dialogs.ok shown - Error Handler for model.changeMessagesReadState-changeMessagesReadState file:MessageListView.js");ws.widget.Dialogs.ok(a||Config.Strings.MarkReadError)}})}},flagMessages:function(a,c){if(c=this.getMessageActionUids(c)){var d=this.model.getOpSize(c),e=this.model.isAllSelected();this.model.flagMessages({uids:c,
flag:a,load:function(){var c="",c=1==d.opSize?a?Config.Strings.MessageFlagged:Config.Strings.MessageUnflagged:e&&!d.havexuids?a?Config.Strings.MessagesFlaggedAll:Config.Strings.MessagesUnflaggedAll:ws.string.substituteParams(a?Config.Strings.MessagesFlagged:Config.Strings.MessagesUnflagged,d.opSize);b.publish("WSFeedbackStart",[c,!0])},error:function(a){window.ws_ErrLgr&&!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.UserVisErr,"Dialogs.ok shown - Error Handler for model.flagMessages-flagMessages file:MessageListView.js");
ws.widget.Dialogs.ok(a||Config.Strings.ErrorSettingFlag)}})}},onClickShowStatus:function(){var a=this.getMessageActionUids(null);a&&(this.model.isAllSelected()||10<a.length?ws.widget.Dialogs.ok(ws.string.substituteParams(Config.Strings.TooManyItemsSelect,10)):this.showStatus(this.model.currentFolder,a))},showStatus:function(a,c){if(!this.statusDialog)this.statusDialog=new u({model:this.model}),b.body().appendChild(this.statusDialog.domNode),this.statusDialog.startup();this.statusDialog.show(a,c);
ws.reporting.reportDLAction("Mail-MessageList-MsgStatus")},onClickFlag:function(){this.flagMessages(!0)},onClickUnflag:function(){this.flagMessages(!1)},createFilter:function(a){require(["ws/mail/MailFilterModalPane"],b.hitch(this,function(c){var d={};if((a=this.getMessageActionUids(a,!0))&&1==a.length){var e=this.model.getUidData(a[0]);d.from=e&&e[this.model.columns.FromToAddress]||""}else if(e=this.model.getSearchString(),"subject"==this.currentSearchIn)d.subject=e||"";else if("fromto"==this.currentSearchIn)d.from=
e||"";d.moveToFolder=this.model.currentFolder;c=new c(d);b.body().appendChild(c.domNode);c.startup()}))},getRowClasses:function(a){var b=this.inherited(arguments),d=this.model.getRowData(a);if(d){var e=Settings.ViewNewOld&&"NewMail"==this.model.getCurrentFolder().type?this.model.columns.Read:this.model.columns.Seen;d[e]&&b.push("row-read");d[this.model.columns.Official]&&b.push("row-official")}return b},handleHoverControlClick:function(a){var c=this.model.getDatum(a.rowIndex,this.model.columns.UID);
b.hasClass(a.target,"trashHover")?this.deleteMessages([c],!0,"clktrsh"):this.inherited(arguments)},handleQuickAction:function(a){var b=this.model.getDatum(this.quickActionRow,this.model.columns.UID);switch(a){case "changeMessagesReadState":this.changeMessagesReadState(!this.model.getDatum(this.quickActionRow,this.model.columns.Seen),[b]);break;case "searchSubject":a=this.model.getDatum(this.quickActionRow,this.model.columns.Subject);a=ws.WebSuite.Navigation.removeSpecialCharacters(this.model.getBaseSubject(a));
ws.WebSuite.setFolderHistory();this.model.search(a,"subject");break;case "searchFrom":ws.WebSuite.setFolderHistory();b=ws.WebSuite.Navigation.removeSpecialCharacters(this.model.getDatum(this.quickActionRow,this.model.columns.FromToAddress));this.model.search(b,"fromto");break;case "searchTo":b=this.model.getDatum(this.quickActionRow,this.model.columns.FromToAddress);Config.UseOMS&&Config.CrossFolderSearch?this.model.search(b,"fromto"):this.model.search(b,"to");break;case "reply":case "replyAll":case "forward":this._respond(a,
[b]);break;case "spam":this.spamAction(!0,[b]);break;case "notSpam":this.spamAction(!1,[b]);break;case "restore":this.restoreMessages([b]);break;case "openInNewWindow":this.openMessage(b,!0);break;case "viewMessageSource":this.viewMessageSource(this.model.currentFolder,b);break;case "flagMessage":this.flagMessages(!this.model.getDatum(this.quickActionRow,this.model.columns.Flag),[b]);break;case "delete":this.deleteMessages([b],!1,"clckdel");break;case "addToCalendar":this.addToCalendar(this.model.currentFolder,
b);break;case "addSenderToContact":b=this.model.getDatum(this.quickActionRow,this.model.columns.FromToAddress);(a=this.isContactExist(b))?this.editContact(a):this.addContact(b);break;case "addRecipientToContact":b=this.model.getDatum(this.quickActionRow,this.model.columns.FromToAddress);(a=this.isContactExist(b))?this.editContact(a):this.addContact(b);break;case "showStatus":this.showStatus(this.model.currentFolder,[b]);break;case "createFilter":this.createFilter([b])}},isContactExist:function(a){if(!a)return null;
a=a.toLowerCase();return ws.WebSuite.theAddressModel.getRecordByEmail(a)},addContact:function(){},editContact:function(){},addToCalendar:function(){},onMouseOverRow:function(a){if(!this._unselect0row&&(this._unselect0row=!0,0!=a.rowIndex))this._overRow=-1,this.grid.updateRow(0);this.inherited(arguments)},setupZeroRowsMessage:function(a,b){this.inherited(arguments);if(b)this.model.trackdl("-MLV.ZRa",this.reportFolderName),ws.reporting.DL.endEvent(this.gridModel.reportFolderName,{opResult:"fail",errType:"api",
errCode:this.model.getErrCode(),sessionID:Settings.SessionID}),this.gridModel.reportFolderName=null;else if(!a)this.model.trackdl("-MLV.ZRb",this.reportFolderName),ws.reporting.DL.endEvent(this.gridModel.reportFolderName,{opResult:"success"}),this.gridModel.reportFolderName=null},getZeroRowsMessage:function(){var a="",a=Config.UseOMS&&Config.CrossFolderSearch?"<div class='search'>"+Config.Strings.SearchMessageNoMatchNoFolder+"</div>":"<div class='search'>"+Config.Strings.SearchMessageNoMatch+"</div>",
a=a+("<div class='zero'><div class='zeroRowHeader'>"+Config.Strings.FolderEmptyList+"</div><div class='mainLargeIcon sunIcon'></div>");Config.EnableTodayCurtain&&(a+="<div class='zeroTodayPromo'>"+ws.string.substituteParams(Config.Strings.GetLatestFromTodayOnAOL,"<a href='#' class='wsLink' onclick=ws.WebSuite.showTodayPage()>",Config.Strings.TodayOnAOL,"</a>")+"</div>");return a+"</div>"},updateZeroRowsView:function(){if(this.isShowingEmptyFolderAd)this.emptyFolderAdDiv.style.display="none",this.splitContainer.domNode.style.display=
"block",this.isShowingEmptyFolderAd=!1,ws.WebSuite.SidePanel.show(!1,1E3);this.inherited(arguments)},beforeShowZeroRowsMessage:function(a,c){var d=b.query(".search",this.zeroRowsNode)[0],e=b.query(".zero",this.zeroRowsNode)[0];this.model.getSearchString()||"all"!=this.model.filter?(ws.html.setShowing(e,!1),ws.html.setShowing(d,!0)):(ws.html.setShowing(e,!0),ws.html.setShowing(d,!1));if(Settings.UserHash>=Config.EmptyFolderAdThreshold&&Config.AdInfo&&Config.AdInfo.emptyFolder_all){this.isShowingEmptyFolderAd=
!1;if(!a&&!c&&this.model&&this.model.activeCachedList&&!1===this.model.activeCachedList.isInbox)this.isShowingEmptyFolderAd=!0;if(this.isShowingEmptyFolderAd){if(!this.emptyFolderAd)d=document.createElement("div"),this.emptyFolderAdDiv.appendChild(d),b.addClass(d,"wsToolbar wsToolbarControls emptyFolderAdHeader"),d.innerHTML=Config.Strings.FolderEmptyList.replace(/\./g,""),d=new r({adtype:"emptyFolder",blocked:!1,checkForHiddenB4Rotate:!0,adDivSetup:function(a){if(!this.multiSize&&(a.style.width=
"100%",a.style.height="100%",(a=b.query("iframe",a))&&a.length))a[0].style.width="100%",a[0].style.height="100%"}}),d.startup(),this.emptyFolderAdDiv.appendChild(d.domNode),this.emptyFolderAd=d;ws.WebSuite.SidePanel.hide();this.emptyFolderAdDiv.style.display="block";this.splitContainer.domNode.style.display="none"}else this.emptyFolderAdDiv.style.display="none",this.splitContainer.domNode.style.display="block";this.emptyFolderAd&&this.emptyFolderAd.block(!this.isShowingEmptyFolderAd,!1)}},getLoadingMessage:function(){var a=
this.model.searchInProgress?Config.Strings.Searching:Config.Strings.Loading;this.errorMessageSearchState=this.model.searchInProgress;this.model.searchInProgress=!1;return a},getErrorMessage:function(){var a="<a href='#' onclick='"+('dijit.byId("'+this.id+'").retryFetch()')+"' class='wsLink'>",b=Config.Strings.ErrorRetrievingMessages;this.errorMessageSearchState&&(b="500:21003"==this.model.getErrCode()?Config.Strings.SearchErrorReindexing:Config.Strings.SearchErrorRetrievingMessages);var d=b;-1<b.indexOf("{0}")&&
-1<b.indexOf("{1}")&&(d=ws.string.substituteParams(b,a,"</a>"));return d},retryFetch:function(){var a=this.model.getSearchString(),b=this.model.getSearchIn();this.errorMessageSearchState&&a&&b?this.model.search(a,b):this.model.setFolder(this.model.currentFolder)},getDragObjectLabel:function(a){var b=this.model.getOpSize(this.getMessageActionUids(null,!0)),b=this.model.isSelected(this.model.getDatum(a,this.model.columns.UID))?b.opSize:1;return 1==b?this.model.getDatum(a,this.model.columns.Subject):
ws.string.substituteParams(Config.Strings.NMessages,b)},getMessageActionUids:function(a,b){if(a&&a.length)return a;if(this.model.currentUid)return[this.model.currentUid];if(this.model.allSelected&&null==this.model.SearchString)return[];var d=this.model.getSelectedUids();if(d.length)return d;b||ws.widget.Dialogs.ok(Config.Strings.NoMessagesCheckedErrorMsg);return null},sprites:{type:{NONE:"",SEEN:"ws_image_fSeen",OFFICIAL:"ws_image_fOfficial",CERTIFIED:"ws_image_fCertified",VOICEMAIL:"ws_image_fVoicemail",
ANSWERED:"ws_image_fAnswered",FORWARDED:"ws_image_fForwarded"},attach:{NONE:"",ATTACHMENT:"ws_image_fAttachment"},flag:{NONE:"ws_image_fUnflagged",FLAGGED:"ws_image_fFlagged"},account:{aol:"iconSaol",att:"iconSatt",hotmail:"iconShotmail",yahoo:"iconSyahoo",gmail:"iconSgmail",generic:"iconSgeneric"}},defineMenus:function(){this.quickActionMenuDefinition={Inbox:[{caption:"",onClick:b.hitch(this,"handleQuickAction","changeMessagesReadState")},{caption:Config.Strings.SearchForSubject,onClick:b.hitch(this,
"handleQuickAction","searchSubject")},{caption:Config.Strings.SearchForFromTo,onClick:b.hitch(this,"handleQuickAction","searchFrom")},{caption:Config.Strings.DisplayReply,onClick:b.hitch(this,"handleQuickAction","reply"),shortCutKey:Config.Strings.KeyMailReply},{caption:Config.Strings.DisplayReplyAll,onClick:b.hitch(this,"handleQuickAction","replyAll"),shortCutKey:Config.Strings.KeyMailReplyAll},{caption:Config.Strings.DisplayForward,onClick:b.hitch(this,"handleQuickAction","forward"),shortCutKey:Config.Strings.KeyMailForward},
{caption:Config.Strings.ReportSpam,onClick:b.hitch(this,"handleQuickAction","spam")},{caption:Config.Strings.ShowMessageStatus,onClick:b.hitch(this,"handleQuickAction","showStatus")},{caption:Config.Strings.MailFilter_CreateFilter,onClick:b.hitch(this,"handleQuickAction","createFilter")},{caption:Config.Strings.ViewMessageSource,onClick:b.hitch(this,"handleQuickAction","viewMessageSource")}],Drafts:[{caption:Config.Strings.SearchForSubject,onClick:b.hitch(this,"handleQuickAction","searchSubject")},
{caption:Config.Strings.SearchForTo,onClick:b.hitch(this,"handleQuickAction","searchTo")}],Sent:[{caption:Config.Strings.SearchForSubject,onClick:b.hitch(this,"handleQuickAction","searchSubject")},{caption:Config.UseOMS&&Config.CrossFolderSearch?Config.Strings.SearchForFromTo:Config.Strings.SearchForTo,onClick:b.hitch(this,"handleQuickAction","searchTo")},{caption:Config.Strings.DisplayReply,onClick:b.hitch(this,"handleQuickAction","reply"),shortCutKey:Config.Strings.KeyMailReply},{caption:Config.Strings.DisplayReplyAll,
onClick:b.hitch(this,"handleQuickAction","replyAll"),shortCutKey:Config.Strings.KeyMailReplyAll},{caption:Config.Strings.DisplayForward,onClick:b.hitch(this,"handleQuickAction","forward"),shortCutKey:Config.Strings.KeyMailForward},{caption:Config.Strings.ShowMessageStatus,onClick:b.hitch(this,"handleQuickAction","showStatus")}],Spam:[{caption:Config.Strings.NotSpamButton,onClick:b.hitch(this,"handleQuickAction","notSpam")},{caption:Config.Strings.SearchForSubject,onClick:b.hitch(this,"handleQuickAction",
"searchSubject")},{caption:Config.Strings.SearchForFromTo,onClick:b.hitch(this,"handleQuickAction","searchFrom")},{caption:Config.Strings.DisplayReply,onClick:b.hitch(this,"handleQuickAction","reply"),shortCutKey:Config.Strings.KeyMailReply},{caption:Config.Strings.DisplayReplyAll,onClick:b.hitch(this,"handleQuickAction","replyAll"),shortCutKey:Config.Strings.KeyMailReplyAll},{caption:Config.Strings.DisplayForward,onClick:b.hitch(this,"handleQuickAction","forward"),shortCutKey:Config.Strings.KeyMailForward},
{caption:Config.Strings.MailFilter_CreateFilter,onClick:b.hitch(this,"handleQuickAction","createFilter")},{caption:Config.Strings.ViewMessageSource,onClick:b.hitch(this,"handleQuickAction","viewMessageSource")}],Deleted:[{caption:Config.Strings.RestoreButton,onClick:b.hitch(this,"handleQuickAction","restore")},{caption:Config.Strings.SearchForSubject,onClick:b.hitch(this,"handleQuickAction","searchSubject")},{caption:Config.Strings.SearchForFromTo,onClick:b.hitch(this,"handleQuickAction","searchFrom")},
{caption:Config.Strings.DisplayReply,onClick:b.hitch(this,"handleQuickAction","reply"),shortCutKey:Config.Strings.KeyMailReply},{caption:Config.Strings.DisplayReplyAll,onClick:b.hitch(this,"handleQuickAction","replyAll"),shortCutKey:Config.Strings.KeyMailReplyAll},{caption:Config.Strings.DisplayForward,onClick:b.hitch(this,"handleQuickAction","forward"),shortCutKey:Config.Strings.KeyMailForward},{caption:Config.Strings.MailFilter_CreateFilter,onClick:b.hitch(this,"handleQuickAction","createFilter")},
{caption:Config.Strings.ViewMessageSource,onClick:b.hitch(this,"handleQuickAction","viewMessageSource")}]};this.filterButton.menuDefinition=[{caption:Config.Strings.FilterAllMenuItem,onClick:b.hitch(this,"onFilterMenu","all")},{separator:!0},{caption:Config.Strings.FilterUnreadMenuItem,onClick:b.hitch(this,"onFilterMenu","unread")},{caption:Config.Strings.FilterReadMenuItem,onClick:b.hitch(this,"onFilterMenu","read")},{separator:!0},{caption:Config.Strings.FilterFlaggedMenuItem,onClick:b.hitch(this,
"onFilterMenu","flagged")},{caption:Config.Strings.FilterUnflaggedMenuItem,onClick:b.hitch(this,"onFilterMenu","unflagged")}];this.customizeButton.menuDefinition=[{caption:Config.Strings.MsgSpacing,isLabel:!0},{caption:"<span class='mainSprite menuItemIcon iconSpace0'></span> <span class='menuIconLabel'>"+Config.Strings.MsgSpacingMode0+"</span>",onClick:b.hitch(this,"setSpacing",0),checked:0==Settings.ListSpacingType},{caption:"<span class='mainSprite menuItemIcon iconSpace1'></span> <span class='menuIconLabel'>"+
Config.Strings.MsgSpacingMode1+"</span>",onClick:b.hitch(this,"setSpacing",1),checked:1==Settings.ListSpacingType},{caption:"<span class='mainSprite menuItemIcon iconSpace2'></span> <span class='menuIconLabel'>"+Config.Strings.MsgSpacingMode2+"</span>",onClick:b.hitch(this,"setSpacing",2),checked:2==Settings.ListSpacingType},{caption:"<span class='mainSprite menuItemIcon iconSpace3'></span> <span class='menuIconLabel'>"+Config.Strings.MsgSpacingMode3+"</span>",onClick:b.hitch(this,"setSpacing",3),
checked:3==Settings.ListSpacingType},{caption:"<span class='mainSprite menuItemIcon iconSpace4'></span> <span class='menuIconLabel'>"+Config.Strings.MsgSpacingMode4+"</span>",onClick:b.hitch(this,"setSpacing",4),checked:4==Settings.ListSpacingType},{separator:!0},{caption:Config.Strings.PreviewPane_Label,isLabel:!0},{caption:Config.Strings.PreviewPane_Show,onClick:b.hitch(this,"togglePreviewPane"),checked:Settings.EnablePreviewPane||!Settings.PreviewPaneIntroSeen},{separator:!0},{caption:Config.Strings.Labels,
isLabel:!0},{caption:Config.Strings.ShowLabels,onClick:b.hitch(this,"toggleButtonLabels"),checked:b.hasClass(b.body(),"btnLabelsOn2")}];this.actionButton.menuDefinition=[{caption:Settings.ViewNewOld?Config.Strings.KeepAsNewActionLabel:Config.Strings.MarkUnreadActionLabel,onClick:b.hitch(this,"changeMessagesReadState",!1)},{caption:Config.Strings.MarkReadActionLabel,onClick:b.hitch(this,"changeMessagesReadState",!0)},{separator:!0},{caption:Config.Strings.FlagQuickActionLabel,onClick:b.hitch(this,
"onClickFlag")},{caption:Config.Strings.ClearFlag,onClick:b.hitch(this,"onClickUnflag")},{separator:!0},{caption:Config.Strings.MailFilter_CreateFilter,onClick:b.hitch(this,"createFilter")},{caption:Config.Strings.ShowMessageStatus,onClick:b.hitch(this,"onClickShowStatus")},{separator:!0}];this.rightClickMenuDefinition={Inbox:[{caption:Config.Strings.OpenInNewWindow,onClick:b.hitch(this,"handleQuickAction","openInNewWindow",!0),shortCutKey:Config.Strings.KeyMailPopout},{separator:!0},{caption:Config.Strings.DisplayReply,
onClick:b.hitch(this,"handleQuickAction","reply",!0),shortCutKey:Config.Strings.KeyMailReply},{caption:Config.Strings.DisplayReplyAll,onClick:b.hitch(this,"handleQuickAction","replyAll",!0),shortCutKey:Config.Strings.KeyMailReplyAll},{caption:Config.Strings.DisplayForward,onClick:b.hitch(this,"handleQuickAction","forward",!0),shortCutKey:Config.Strings.KeyMailForward},{separator:!0},{caption:"",onClick:b.hitch(this,"handleQuickAction","changeMessagesReadState",!0)},{caption:"",onClick:b.hitch(this,
"handleQuickAction","flagMessage",!0)},{caption:Config.Strings.Delete,onClick:b.hitch(this,"handleQuickAction","delete",!0)},{caption:Config.Strings.ReportSpam,onClick:b.hitch(this,"handleQuickAction","spam",!0)},{caption:Config.Strings.ShowMessageStatus,onClick:b.hitch(this,"handleQuickAction","showStatus",!0)},{caption:Config.Strings.MailFilter_CreateFilter1,onClick:b.hitch(this,"handleQuickAction","createFilter",!0)},{separator:!0},{caption:Config.Strings.SearchForFromTo,onClick:b.hitch(this,"handleQuickAction",
"searchFrom",!0)},{caption:Config.Strings.SearchForSubject,onClick:b.hitch(this,"handleQuickAction","searchSubject",!0)},{separator:!0},{caption:"",onClick:b.hitch(this,"handleQuickAction","addSenderToContact",!0)},{caption:Config.Strings.AddMessageToCalendar,onClick:b.hitch(this,"handleQuickAction","addToCalendar",!0)},{separator:!0},{caption:Config.Strings.ViewMessageSource,onClick:b.hitch(this,"handleQuickAction","viewMessageSource",!0)}],Drafts:[{caption:Config.Strings.OpenInNewWindow,onClick:b.hitch(this,
"handleQuickAction","openInNewWindow",!0),shortCutKey:Config.Strings.KeyMailPopout},{separator:!0},{caption:"",onClick:b.hitch(this,"handleQuickAction","flagMessage",!0)},{caption:Config.Strings.Delete,onClick:b.hitch(this,"handleQuickAction","delete",!0)}],Sent:[{caption:Config.Strings.OpenInNewWindow,onClick:b.hitch(this,"handleQuickAction","openInNewWindow",!0),shortCutKey:Config.Strings.KeyMailPopout},{separator:!0},{caption:Config.Strings.DisplayReply,onClick:b.hitch(this,"handleQuickAction",
"reply",!0),shortCutKey:Config.Strings.KeyMailReply},{caption:Config.Strings.DisplayReplyAll,onClick:b.hitch(this,"handleQuickAction","replyAll",!0),shortCutKey:Config.Strings.KeyMailReplyAll},{caption:Config.Strings.DisplayForward,onClick:b.hitch(this,"handleQuickAction","forward",!0),shortCutKey:Config.Strings.KeyMailForward},{separator:!0},{caption:"",onClick:b.hitch(this,"handleQuickAction","changeMessagesReadState",!0)},{caption:"",onClick:b.hitch(this,"handleQuickAction","flagMessage",!0)},
{caption:Config.Strings.Delete,onClick:b.hitch(this,"handleQuickAction","delete",!0)},{caption:Config.Strings.ShowMessageStatus,onClick:b.hitch(this,"handleQuickAction","showStatus",!0)},{separator:!0},{caption:Config.UseOMS&&Config.CrossFolderSearch?Config.Strings.SearchForFromTo:Config.Strings.SearchForTo,onClick:b.hitch(this,"handleQuickAction","searchTo")},{caption:Config.Strings.SearchForSubject,onClick:b.hitch(this,"handleQuickAction","searchSubject",!0)},{separator:!0},{caption:"",onClick:b.hitch(this,
"handleQuickAction","addRecipientToContact",!0)}],Spam:[{caption:Config.Strings.OpenInNewWindow,onClick:b.hitch(this,"handleQuickAction","openInNewWindow",!0),shortCutKey:Config.Strings.KeyMailPopout},{separator:!0},{caption:Config.Strings.DisplayReply,onClick:b.hitch(this,"handleQuickAction","reply",!0),shortCutKey:Config.Strings.KeyMailReply},{caption:Config.Strings.DisplayReplyAll,onClick:b.hitch(this,"handleQuickAction","replyAll",!0),shortCutKey:Config.Strings.KeyMailReplyAll},{caption:Config.Strings.DisplayForward,
onClick:b.hitch(this,"handleQuickAction","forward",!0),shortCutKey:Config.Strings.KeyMailForward},{separator:!0},{caption:"",onClick:b.hitch(this,"handleQuickAction","changeMessagesReadState",!0)},{caption:"",onClick:b.hitch(this,"handleQuickAction","flagMessage",!0)},{caption:Config.Strings.Delete,onClick:b.hitch(this,"handleQuickAction","delete",!0)},{caption:Config.Strings.NotSpamButton,onClick:b.hitch(this,"handleQuickAction","notSpam",!0)},{separator:!0},{caption:Config.Strings.SearchForFromTo,
onClick:b.hitch(this,"handleQuickAction","searchFrom",!0)},{caption:Config.Strings.SearchForSubject,onClick:b.hitch(this,"handleQuickAction","searchSubject",!0)},{separator:!0},{caption:Config.Strings.ViewMessageSource,onClick:b.hitch(this,"handleQuickAction","viewMessageSource",!0)}],Deleted:[{caption:Config.Strings.OpenInNewWindow,onClick:b.hitch(this,"handleQuickAction","openInNewWindow",!0),shortCutKey:Config.Strings.KeyMailPopout},{separator:!0},{caption:Config.Strings.DisplayReply,onClick:b.hitch(this,
"handleQuickAction","reply",!0),shortCutKey:Config.Strings.KeyMailReply},{caption:Config.Strings.DisplayReplyAll,onClick:b.hitch(this,"handleQuickAction","replyAll",!0),shortCutKey:Config.Strings.KeyMailReplyAll},{caption:Config.Strings.DisplayForward,onClick:b.hitch(this,"handleQuickAction","forward",!0),shortCutKey:Config.Strings.KeyMailForward},{separator:!0},{caption:Config.Strings.RestoreButton,onClick:b.hitch(this,"handleQuickAction","restore",!0)},{caption:"",onClick:b.hitch(this,"handleQuickAction",
"changeMessagesReadState",!0)},{caption:"",onClick:b.hitch(this,"handleQuickAction","flagMessage",!0)},{caption:Config.Strings.Delete,onClick:b.hitch(this,"handleQuickAction","delete",!0)},{caption:Config.Strings.ReportSpam,onClick:b.hitch(this,"handleQuickAction","spam",!0)},{separator:!0},{caption:Config.Strings.SearchForFromTo,onClick:b.hitch(this,"handleQuickAction","searchFrom",!0)},{caption:Config.Strings.SearchForSubject,onClick:b.hitch(this,"handleQuickAction","searchSubject",!0)},{separator:!0},
{caption:"",onClick:b.hitch(this,"handleQuickAction","addSenderToContact",!0)},{caption:Config.Strings.AddMessageToCalendar,onClick:b.hitch(this,"handleQuickAction","addToCalendar",!0)},{separator:!0},{caption:Config.Strings.ViewMessageSource,onClick:b.hitch(this,"handleQuickAction","viewMessageSource",!0)}]};b.connect(this.actionButton,"updateMenu",this,"updateActionMenu");b.connect(this.filterButton,"updateMenu",this,"updateFilterMenu")},createQuickActionMenu:function(a){var c=this.quickActionMenuDefinition[a];
if(!c)c=this.quickActionMenuDefinition.Inbox;this.quickActionMenu[a]=ws.widget.createMenu(c);b.connect(this.quickActionMenu[a],"onClose",b.hitch(this,function(){this.grid.updateRow(this.quickActionRow);this.updateToolbarState()}));return this.quickActionMenu[a]},getQuickActionMenu:function(a){if(!this.quickActionMenu)this.quickActionMenu={};var b=this.model.getFolderByName(this.model.currentFolder),b=b?b.type:"Inbox";this.quickActionMenuDefinition[b]||(b="SavedIMs"==this.model.currentFolder?"Sent":
"Inbox");var d=this.quickActionMenu[b];!d&&!a&&(d=this.createQuickActionMenu(b));return d},updateQuickActionMenu:function(a){var c=a.getChildren(),d=Config.FolderButtons[Config.DeletedItemsFolderName.toLowerCase()],d=b.map(d.split(","),function(a){return"true"==b.trim(a)});if(a==this.quickActionMenu.Inbox){var e=Settings.ViewNewOld?Config.Strings.KeepAsNewActionLabel:Config.Strings.MarkUnreadActionLabel,f=Config.Strings.MarkReadActionLabel,g=this.model.getDatum(this.quickActionRow,this.model.columns.Seen);
c[0].setCaption(g?e:f);c[0].setShowing(this.model.canChangeMessageReadState());c[6].setShowing(Config.EnableSpamButton);c[7].setShowing("ANGELIA"==ws.UserContext.MailboxType?Config.ShowMessageStatus&&Config.UseOMS:Config.ShowMessageStatus);c[8].setShowing(Config.EnableFiltersSettings)}a==this.quickActionMenu.Sent&&c[5].setShowing("ANGELIA"==ws.UserContext.MailboxType?Config.ShowMessageStatus&&Config.UseOMS:Config.ShowMessageStatus);a==this.quickActionMenu.Spam&&(c[0].setShowing(Config.EnableSpamButton),
c[6].setShowing(Config.EnableFiltersSettings));a==this.quickActionMenu.Deleted&&(c[0].setShowing(d[8]||Settings.ViewNewOld),c[6].setShowing(Config.EnableFiltersSettings));this.model.getSearchString()&&Config.UseOMS&&Config.CrossFolderSearch?c[2].setCaption(Config.Strings.SearchForFromTo):a==this.quickActionMenu.Sent||a==this.quickActionMenu.Drafts?c[1].setCaption(Config.Strings.SearchForTo):a==this.quickActionMenu.Deleted?c[2].Caption==Config.Strings.SearchForSender||c[2].Caption==Config.Strings.SearchForTo?
c[2].setCaption(Config.Strings.SearchForSender):(c[1].Caption==Config.Strings.SearchForSender||c[1].Caption==Config.Strings.SearchForTo)&&c[1].setCaption(Config.Strings.SearchForSender):c[2].setCaption(Config.Strings.SearchForSender)},createRightClickMenu:function(a){var c=this.rightClickMenuDefinition[a];if(!c)c=this.rightClickMenuDefinition.Inbox;this.rightClickMenu[a]=ws.widget.createMenu(c);b.connect(this.rightClickMenu[a],"close",b.hitch(this,function(){var a=this.quickActionRow;-1!=this.gridModel.columns.Hover&&
this.grid.update(a,this.gridModel.columns.Hover)}));return this.rightClickMenu[a]},getRightClickMenu:function(a){if(!this.rightClickMenu)this.rightClickMenu={};var c=this.model.getFolderByName(this.model.currentFolder).type;this.rightClickMenuDefinition[c]||(c="SavedIMs"==c?"Sent":"Inbox");var d=this.rightClickMenu[c];!d&&!a&&(d=this.createRightClickMenu(c),b.connect(d,"onClose",this,"OnCloseContextMenu"));return d},updateRightClickMenu:function(a){var b=null,d=null,e=null,f=a.getChildren();f[0].setShowing(ws.settings.allowPopups());
f[1].setShowing(ws.settings.allowPopups());if(a==this.rightClickMenu.Inbox||a==this.rightClickMenu.Spam||a==this.rightClickMenu.Sent)b=f[6],d=f[7];a==this.rightClickMenu.Inbox&&(e=f[16],f[9].setShowing(Config.EnableSpamButton),f[10].setShowing("ANGELIA"==ws.UserContext.MailboxType?Config.ShowMessageStatus&&Config.UseOMS:Config.ShowMessageStatus),f[11].setShowing(Config.EnableFiltersSettings));a==this.rightClickMenu.Sent&&(e=f[14],f[9].setShowing("ANGELIA"==ws.UserContext.MailboxType?Config.ShowMessageStatus&&
Config.UseOMS:Config.ShowMessageStatus));a==this.rightClickMenu.Deleted&&(b=f[7],d=f[8],e=f[15],f[6].setShowing(Config.EnableRestoreButton||Settings.ViewNewOld),f[10].setShowing(Config.EnableSpamButton));a==this.rightClickMenu.Drafts&&(d=f[2]);a==this.rightClickMenu.Spam&&f[9].setShowing(Config.EnableSpamButton);if(b){var a=Settings.ViewNewOld?Config.Strings.KeepAsNewActionLabel:Config.Strings.MarkUnreadActionLabel,g=Config.Strings.MarkReadActionLabel,h=this.model.getDatum(this.quickActionRow,this.model.columns.Seen);
b.setCaption(h?a:g);b.setShowing(this.model.canChangeMessageReadState())}d&&(b=this.model.getDatum(this.quickActionRow,this.model.columns.Flag),d.setCaption(b?Config.Strings.ClearFlag:Config.Strings.FlagForFollowUp));e&&(d=this.model.getDatum(this.quickActionRow,this.model.columns.FromToAddress),e.setCaption(this.isContactExist(d)?Config.Strings.EditContact:Config.Strings.AddToContact));this.model.getSearchString()&&Config.UseOMS&&Config.CrossFolderSearch&&f[13].setCaption(Config.Strings.SearchForFromTo)},
onEnterKeyPress:function(a){var b=this.model.getDatum(a,this.model.columns.UID);if(this.checkNullUid("onEnterKeyPress",b,a)){var d=null;Config.UseOMS&&Config.CrossFolderSearch&&(d=this.model.getDatum(a,this.model.columns.Folder));this.openMessage(b,!1,!0,!1,!1,d)}},onDelKeyPress:function(a){var c;this.model.isAllSelected()?a=null:b.isArray(a)?c=!1:(a=[this.model.getDatum(a,this.model.columns.UID)],c=!0);this.deleteMessages(a,c,"delekey")},onKeyPress:function(a){this.isShowing()&&this._onKeyPress(a)},
onOtherKeyPress:function(a,c){if("undefined"==typeof c||null==c)c=-1;var d=-1<c?c:this.grid.rows.overRow;if(!(0>d)&&Config.EnableKeyboardShortcuts&&a.keyChar&&b.isString(a.keyChar)&&!a.ctrlKey&&!a.altKey&&!a.metaKey){var e=this.getQuickActionMenu(!0);e&&e.close();e=this.model.getDatum(d,this.model.columns.UID);if(this.checkNullUid("onOtherKeyPress",e,d))switch(a.keyChar.toLowerCase()){case Config.Strings.KeyMailReply:this._respond("reply",[e],a);break;case Config.Strings.KeyMailReplyAll:this._respond("replyAll",
[e],a);break;case Config.Strings.KeyMailForward:this._respond("forward",[e],a);break;case Config.Strings.KeyMailKeepAsNew:this.changeMessagesReadState(!1,[e]);break;case Config.Strings.KeyMailSpam:if(d=null,this.spamButton.isShowing()?d=!0:this.notSpamButton.isShowing()&&(d=!1),null!=d){var f=[];b.isFunction(this.model.getSelectedUids)?f=this.model.getSelectedUids():b.isFunction(this.gridModel.getSelectedUids)&&(f=this.gridModel.getSelectedUids());if(!f||!f.length)f=[e];this.spamAction(d,f)}}}},onResized:function(){var a=
b.query(".dojoxGrid-scrollbox",this.domNode)[0],c=null;if(a)c=a.scrollTop;this.splitContainer.resize();b.isFF&&null!=c&&setTimeout(function(){a.scrollTop=c},0)},wrapToolbar:function(){this.toolbar.skipLayout=!0;this.layoutWidget.resize()},onShow:function(){ws.bubbleConfig.showPinBubble("CustomizeMenu",this.customizeButton.domNode,!0);(Settings.EnablePreviewPane||!Settings.PreviewPaneIntroSeen)!=!(!this.fakePreviewPane&&!this.previewPane)&&ws.lang.setTimeout(this,"setPreviewPaneEnabled",0,Settings.EnablePreviewPane);
if(this.previewPane)this.previewPane.onShow();this.updateForwardingInfo();this.inherited(arguments)},onHide:function(){ws.bubbleConfig.hidePinBubble("CustomizeMenu",!0);this.inherited(arguments)},editDraft:function(){var a=this.getMessageActionUids();a&&1==a.length?this.openMessage(a[0],!1,!0):this.model.deselectAll()},setupInlineAd:function(){!ws.WebSuite.externalNotificationInitilized&&0<this.fetchNotificationCount&&(setTimeout(b.hitch(this,"setupInlineAd"),500),this.fetchNotificationCount--);if("undefined"!=
typeof notificationMsgs&&0<notificationMsgs.length){var a=window.notificationMsgs;ws.WebSuite.getNotificationsSeenIds();for(var c=0;c<a.length;c++){var d=a[c];if("ad"==d.type){if(ws.WebSuite.hasNotifcationBeenSeen(d.id)){this.hideKeywordAdWidget();return}a=d.msg.split(",",2);c="";if(2>a.length)break;else c=a[1];this.hideKeywordAdWidget();this.mlistAdCont.domNode.style.display="block";this.mlistAdClose.style.display=d.close?"block":"none";this.adWidget&&this.adWidget.domNode?this.adWidget.hideAd(!1):
(this.adWidget=new r({adtype:"mlistinline"}),this.adWidget.startup(),this.adWidget.currentMagic=c,this.adWidget.setAdId(d.id),this.adWidget.adConfig&&this.mlistAd.appendChild(this.adWidget.domNode));this.currentMsgListAd=this.adWidget;this.layoutWidget.layout();return}}this.mlistAdCont.domNode.style.display=""}else this.hideAdWidget(),this.hideKeywordAdWidget()},closeAd:function(){this.mlistAdCont.domNode.style.display="";this.layoutWidget.layout();if(null!=this.currentMsgListAd)ws.WebSuite.getNotificationsSeenIds(),
ws.WebSuite.seenNotificationIds[ws.WebSuite.seenNotificationIds.length]=this.currentMsgListAd.getAdId(),ws.settings.saveSoon({SeenNotificationMsgs:ws.WebSuite.seenNotificationIds}),this.currentMsgListAd.destroy(),this.currentMsgListAd=null}})})},"url:ws/mail/MessageListView.html":'<div>\n\t<div data-dojo-type="ws/widget/WSSplitContainer" style="height: 100%; width: 100%;" data-dojo-attach-point="splitContainer" sizerWidth="10" orientation="vertical" persist="false">\n\t\t<div class="listView messageListView" data-dojo-type="dijit/layout/BorderContainer" data-dojo-attach-point="layoutWidget">\n            <div data-dojo-type="ws/widget/SingleLineNotification" data-dojo-attach-point="notification" class="notification" data-dojo-props="region:\'top\'" style="display:none"></div>\n\t\t\t<div data-dojo-type="ws/widget/WSToolbar" data-dojo-attach-point="toolbar" data-dojo-props="region:\'top\'" vizType="Controls">\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="restoreButton" iconClassName="restoreIcon" data-dojo-attach-event="onClick: onClickRestore" title="${RestoreButton}">${RestoreButton}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="keepNewButton" iconClassName="keepNewIcon" data-dojo-attach-event="onClick: markMessagesUnread" title="${MsgListKeepAsNewTip}" tip="${KeepAsNewActionLabel} <span>(${KeyMailKeepAsNew})</span>">${KeepAsNewActionLabel}</div>\n\t\t\t\t<div style="display:none" data-dojo-type="ws/widget/Button" data-dojo-attach-event="onClick: editDraft, onMouseDown: savePreviewPaneSelection" data-dojo-attach-point="editDraftButton" iconClassName="editDraftIcon" title="${EditDraft}">${EditDraft}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-event="onClick: reply, onMouseDown: savePreviewPaneSelection" data-dojo-attach-point="replyButton" iconClassName="replyIcon" title="${DisplayReply} (${KeyMailReply})" tip="${DisplayReply} <span>(${KeyMailReply})</span>">${DisplayReply}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-event="onClick: replyAll, onMouseDown: savePreviewPaneSelection" data-dojo-attach-point="replyAllButton" iconClassName="replyAllIcon" title="${DisplayReplyAll} (${KeyMailReplyAll})" tip="${DisplayReplyAll} <span>(${KeyMailReplyAll})</span>">${DisplayReplyAll}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-event="onClick: forward, onMouseDown: savePreviewPaneSelection" data-dojo-attach-point="forwardButton" iconClassName="forwardIcon" title="${DisplayForward} (${KeyMailForward})" tip="${DisplayForward} <span>(${KeyMailForward})</span>">${DisplayForward}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="restartIMButton" data-dojo-attach-event="onClick: restartIM" iconClassName="iconIM" title="${DisplayIM}">${DisplayIM}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/DropDownButton" data-dojo-attach-point="comboIMButton" iconClassName="imIcon" title="${SendIM}">${SendIMPrefix}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/DropDownButton" data-dojo-attach-point="actionButton" iconClassName="actionIcon" tip="${ActionButtonTip}" title="${ActionButtonTip}">${ActionButton}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="deleteButton" iconClassName="delIcon" data-dojo-attach-event="onClick:onClickDelete" tip="${DeleteButton} <span>(${DeleteKey})</span>">${DeleteButton}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="spamButton" iconClassName="spamIcon" data-dojo-attach-event="onClick: reportSpam" title="${MsgListSpamTip}" tip="${ReportSpamTooltip} <span>(${KeyMailSpam})</span>">${ReportSpamButton}</div>\n\t\t\t\t<div data-dojo-type="ws/widget/Button" data-dojo-attach-point="notSpamButton" iconClassName="notSpamIcon" data-dojo-attach-event="onClick: reportNotSpam" title="${NotSpamButton} <span>(${KeyMailSpam})</span>">${NotSpamButton}</div>\n\t\t\t\t<div data-dojo-props="toolbarPosition: \'right\'" data-dojo-type="ws/widget/Pane" class="msgListTbRight">\n\t\t\t\t\t<div data-dojo-type="ws/widget/DropDownButton" data-dojo-attach-point="filterButton" widgetId="filterDropDown"></div>\n\t\t\t\t\t<div data-dojo-type="ws/widget/DropDownButton" data-dojo-attach-point="customizeButton">${Customize}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div data-dojo-type="ws/widget/Pane" data-dojo-attach-point="searchInfoPane" class="searchInfo" data-dojo-props="region:\'top\'" style="display:none">\n\t\t\t\t<div class="searchData">\n\t\t\t\t\t<span data-dojo-attach-point="searchResultsNode"></span>\n\t\t\t\t</div>\n\t\t\t\t<div data-dojo-type="ws/widget/DropDownButton" type="Bare" data-dojo-attach-point="fsButton" title="${FilterSearchTip}" size="Large">${FilterSearch}</div>\n\t\t\t\t<div class="mainSprite wsCloseBtn" data-dojo-attach-event="onclick:clearSearch"></div>\n\t\t\t</div>\n\t\t\t<div data-dojo-type="ws/widget/Pane" data-dojo-attach-point="forwardingInfoPane" class="searchInfo" data-dojo-props="region:\'top\'" style="display: none;">\n\t\t\t\t<div style="float:left">\n\t\t\t\t\t<span data-dojo-attach-point="forwardingInfoNode"></span>\n\t\t\t\t\t&nbsp;&nbsp;\n\t\t\t\t\t<span class="wsLink" data-dojo-attach-event="onclick: openPremiumSettings" title="${PremiumForwardingOnTitle}">${Edit}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div data-dojo-type="ws/widget/Pane" data-dojo-attach-point="mlistAdCont" class="mlistAdCont" data-dojo-props="region:\'top\'">\n\t\t\t\t<div data-dojo-attach-point="mlistAd" class="mlistAd">\n\t\t\t\t</div>\n\t\t\t\t<div class="mainSprite mlistAdClose" data-dojo-attach-point="mlistAdClose" data-dojo-attach-event="onclick: closeAd"></div>\n\t\t\t</div>\n\t\t\t<div data-dojo-type="ws/widget/Pane" data-dojo-props="region:\'center\'">\n\t\t\t\t<div data-dojo-attach-point="grid" data-dojo-type="dojox.grid.Grid"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="emptyFolderAdDiv" style="display:none;height: 100%; width: 100%;" data-dojo-attach-point="emptyFolderAdDiv"></div>\n</div>',
"ws/mail/MessageGridModel":function(){define("ws/mail/MessageGridModel",["dojo/_base/declare","dojo","dojox/grid/data/Dynamic","dojox/grid/Grid"],function(p,q,s){p=p([s],{columns:{Select:0,Type:1,FromTo:2,Hover:3,Attachment:4,Subject:5,Received:6,Flag:7,Folder:8,Size:9,Account:10},sortableCols:"FromTo,Attachment,Subject,Received,Flag,Size,Folder,Account".split(","),reportFolderName:null,constructor:function(b,j,g){this.model=g;if(!Settings.ShowTodayAtSignIn)b=this.model.currentFolder,j=this.model.getFolderByName(b),
ws.reporting.DL.startEvent("list_folder",b,{opData:j&&j.displayName?j.displayName:""}),this.model.trackdl("-MLV.Ca",b),this.reportFolderName=b;q.connect(this.model,"changeRow",this,"onChangeRow");q.connect(this.model,"modelUpdated",this,"modelUpdated")},modelUpdated:function(){},getRowCount:function(){return this.model.getRowCount()},typeTips:{ANSWERED:Config.Strings.RepliedTip,FORWARDED:Config.Strings.ForwardedTip,OFFICIAL:Config.Strings.AOLOfficialMail,CERTIFIED:Config.Strings.AOLCertifiedMail,
VOICEMAIL:Config.Strings.AOLVoiceMail},getDatum:function(b,j){if(0==this.model.getRowCount()||isNaN(b))return"";var g=this.model.getRowData(b);if(null==g)return j==this.columns.Subject?"...":"";if(this.reportFolderName&&this.reportFolderName==this.model.currentFolder)this.model.trackdl("-MLV.GDz",this.reportFolderName),ws.reporting.DL.endEvent(this.reportFolderName,{opResult:"success",msgCount:this.model.getRowCount()}),this.reportFolderName=null;var l=g[this.model.columns.UID],h="Invalid Column";
switch(j){case this.columns.Select:h=[this.model.isSelected(l)?"ON":"OFF",Config.Strings.CheckboxTip];break;case this.columns.Type:g=this.model.getTypeName(g);h=[g,this.typeTips[g]];break;case this.columns.FromTo:h=g[this.model.columns.FromToAddress]||Config.Strings.None;l="";Config.UseOMS&&Config.FriendlyName&&null!=g[this.model.columns.Description]&&""!=g[this.model.columns.Description]&&!0==Settings.ShowSenderDisplayName&&(l=" title='"+h+"'",h=ws.string.escapeXml(g[this.model.columns.Description]));
var h=this.markupSearchString(h,"fromto"),o="";if(Settings.UserHash>=Config.SpamDispositionThreshold){var m=ws.WebSuite.spmGetDetailFromCode(g[this.model.columns.spamReason]),n="Spam"===this.model.currentFolder,p=ws.WebSuite.spamReasonUpdater(m.reason,n,g[this.model.columns.isSpam],this.model),m=m.detail,q=g[this.model.columns.UID],r=!n;""===m&&"permitlist"===p&&""!==g[this.model.columns.FromToAddress]&&(m=g[this.model.columns.FromToAddress]);ws.WebSuite.spamReasonShouldBeShown(p,n)&&(o="<img id='sdIcn"+
g[0]+"' src='"+Config.SpacerImageURL+"' class='mainSprite sdIcon' onmouseover='if(ws.WebSuite.sdTip&&ws.WebSuite.sdTip.timeoutHide){clearTimeout(ws.WebSuite.sdTip.timeoutHide);}ws.WebSuite.showSpmDspnTip(this, event, \""+p+'", "'+m+'", "'+q+'", "'+r+"\");' onmouseout='if(ws.WebSuite.isHandlingFltrSdTip){ws.WebSuite.msOutHandlingFltrSdTip=true;setTimeout(dojo.hitch(this, function(){this.onmouseout({target:this});}),100);}else if(ws.WebSuite.sdTip){ws.WebSuite.msOutHandlingFltrSdTip=false;ws.WebSuite.sdTip.timeoutHide=setTimeout(function(){if(ws.WebSuite.sdTip){clearTimeout(ws.WebSuite.sdTip.timeoutHide);ws.WebSuite.sdTip.timeoutHide=null;ws.WebSuite.sdTip.hide();}},300);}else{ws.WebSuite.msOutHandlingFltrSdTip=false;}' onclick='ws.WebSuite.sdTip.timeoutHide=setTimeout(function(){if(ws.WebSuite.sdTip){clearTimeout(ws.WebSuite.sdTip.timeoutHide);ws.WebSuite.sdTip.timeoutHide=null;ws.WebSuite.sdTip.hide();}},300);' />")}h=
o+"<span"+l+" style='white-space:nowrap' class='fromAddress'>"+h+"</span>";break;case this.columns.Hover:h=this.getHoverColumnCB?this.getHoverColumnCB(b):"";break;case this.columns.Attachment:h=g[this.model.columns.Attachment]?"ATTACHMENT":"NONE";break;case this.columns.Subject:h=g[this.model.columns.Subject]||Config.Strings.NoSubject;h=ws.string.escapeXml(h);g=g[this.model.columns.Fragment];h="<span title='"+h+"' style='white-space: nowrap;'>"+this.markupSearchString(h,"subject")+"</span>";4==ws.WebSuite.heightMode&&
""!=g?h+="<br><span class='frag'>"+g+"</span>":ws.WebSuite.snippetsOn&&(h+="<span class='frag frag2'> - "+g+"</span>");break;case this.columns.Received:h=ws.date.shortestDate(g[this.model.columns.Received],!0);break;case this.columns.Flag:h=g[this.model.columns.Flag]?["FLAGGED",Config.Strings.FlaggedTip]:["NONE",Config.Strings.FlagTip];break;case this.columns.Size:h=this.getDisplaySize(g[this.model.columns.Size]);break;case this.columns.Folder:if(h=g[this.model.columns.Folder])g=this.model.getFolderByName(h),
h="Aggregated"==g.type||"Inbox"==g.type?Config.Strings.Folder_Inbox:g.displayName;break;case this.columns.Account:g=g[this.model.columns.Account],h=this.model.getIdentities(),h=[h[g][3],h[g][0]==h[g][1]?h[g][0]:h[g][0]+"  "+h[g][1]]}return h},getDisplaySize:function(b){1024>b&&(b=1024);return 1048576>b?Math.round(b/1024)+Config.Strings.KilobytesShort:1073741824>b?Math.round(b/1048576)+Config.Strings.MegabytesShort:Math.round(b/1073741824)+Config.Strings.GigabytesShort},getSortColumnIndex:function(b){var j=
"";switch(b){case this.columns.Type:j="Info";break;case this.columns.FromTo:j="FromToAddress";break;case this.columns.Hover:j="QuickAction";break;case this.columns.Attachment:j="Attachment";break;case this.columns.Subject:j="Subject";break;case this.columns.Received:j="Received";break;case this.columns.Flag:j="Flag";break;case this.columns.Size:j="Size";break;case this.columns.Folder:j="Folder";break;case this.columns.Account:j="Account"}return j},markupSearchString:function(b,j){var g=this.model.getSearchString(),
l=this.model.getSearchIn();if(g&&(l==j||"alltext"==l))if(g=ws.string.escapeXml(g),-1!=b.toLowerCase().indexOf(g.toLowerCase())){for(var l=b,h=l.toLowerCase(),o=g.length,g=g.toLowerCase(),m=[],n=h.indexOf(g);-1!=n;)m.push(l.substr(0,n)),m.push("<span class='searchTerm'>",l.substr(n,o),"</span>"),l=l.substr(n+o),h=h.substr(n+o),n=h.indexOf(g);m.push(l);b=m.join("")}return b},onChangeRow:function(b){this.rowChange(null,b)},canSort:function(b){b=Math.abs(b)-1;return q.some(this.sortableCols,function(j){return b==
this.columns[j]},this)},sort:function(b){var j=this.getSortColumnIndex(Math.abs(b)-1);ws.reporting.report("Sort Messages - "+j,"Mail");this.model.sort(j,0>b?"descending":"ascending")}});return ws.mail.MessageGridModel=p})},"url:ws/mail/MessageListView.css":""}});define("release/MessageList",[],1);